;-------------------------------------------------------------------------------
;非TARGET依存性SOURCE
;-------------------------------------------------------------------------------
;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_EXP(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	SIF SOURCE:奴隷:快Ｃ
		EXP:奴隷:Ｃ経験 ++
	IF SOURCE:奴隷:快Ｖ && (!TALENT:奴隷:処女 || !TFLAG:2)
		EXP:奴隷:Ｖ経験 ++
	ENDIF
	SIF SOURCE:奴隷:快Ａ
		EXP:奴隷:Ａ経験 ++
	SIF SOURCE:奴隷:快Ｂ
		EXP:奴隷:Ｂ経験 ++
	SIF CFLAG:奴隷:ローター挿入 && EXP_UP(1,奴隷) > 0
		EXP:奴隷:Ｖ経験 --
	SIF CFLAG:奴隷:ローターA挿入 && EXP_UP(2,奴隷) > 0
		EXP:奴隷:Ａ経験 --

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_快Ｃ(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;Ｃ敏感とＣ鈍感はここで処理
	SOURCE:奴隷:快Ｃ = SOURCE:奴隷:快Ｃ * (2 + TALENT:奴隷:Ｃ感度) / 2
	;C感覚
	SOURCE:奴隷:快Ｃ = SOURCE:奴隷:快Ｃ * SOURCE_REVISION1(ABL:奴隷:Ｃ感覚) / 10
	LOCAL = SOURCE:奴隷:快Ｃ
	;PALAM:欲情をみる
	IF PALAM:奴隷:欲情 < PALAMLV:1
		TIMES LOCAL , 0.80
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:2
		TIMES LOCAL , 1.00
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:3
		TIMES LOCAL , 1.20
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:4
		TIMES LOCAL , 1.40
	ELSEIF PALAM:奴隷:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.60
	ENDIF
	CUP:奴隷:快Ｃ += LOCAL
	LOCAL = SOURCE:奴隷:快Ｃ
	;ABL:欲望をみる
	LOCAL = LOCAL * SOURCE_REVISION2(ABL:奴隷:欲望) / 100
	CUP:奴隷:欲情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_快Ｖ(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;Ｖ敏感とＶ鈍感はここで処理
	SOURCE:奴隷:快Ｖ = SOURCE:奴隷:快Ｖ * (2 + TALENT:奴隷:Ｖ感度) / 2
	;V感覚
	SOURCE:奴隷:快Ｖ = SOURCE:奴隷:快Ｖ * SOURCE_REVISION1(ABL:奴隷:Ｖ感覚) / 10
	;EXP:Ｖ経験をみる
	IF EXP:奴隷:Ｖ経験 < EXPLV:1
		TIMES SOURCE:奴隷:快Ｖ , 0.30
	ELSEIF EXP:奴隷:Ｖ経験 < EXPLV:2
		TIMES SOURCE:奴隷:快Ｖ , 0.50
	ELSEIF EXP:奴隷:Ｖ経験 < EXPLV:3
		TIMES SOURCE:奴隷:快Ｖ , 0.80
	ELSEIF EXP:奴隷:Ｖ経験 < EXPLV:4
		TIMES SOURCE:奴隷:快Ｖ , 1.00
	ELSEIF EXP:奴隷:Ｖ経験 < EXPLV:5
		TIMES SOURCE:奴隷:快Ｖ , 1.20
	ELSEIF EXP:奴隷:Ｖ経験 >= EXPLV:5
		TIMES SOURCE:奴隷:快Ｖ , 1.50
	ENDIF
	;PALAM:潤滑をみる
	IF PALAM:奴隷:潤滑 < PALAMLV:1
		TIMES SOURCE:奴隷:快Ｖ , 0.10
	ELSEIF PALAM:奴隷:潤滑 < PALAMLV:2
		TIMES SOURCE:奴隷:快Ｖ , 0.40
	ELSEIF PALAM:奴隷:潤滑 < PALAMLV:3
		TIMES SOURCE:奴隷:快Ｖ , 0.60
	ELSEIF PALAM:奴隷:潤滑 < PALAMLV:4
		TIMES SOURCE:奴隷:快Ｖ , 0.80
	ELSEIF PALAM:奴隷:潤滑 >= PALAMLV:4
		TIMES SOURCE:奴隷:快Ｖ , 1.00
	ENDIF
	LOCAL = SOURCE:奴隷:快Ｖ
	LOCAL:1 = SOURCE:奴隷:快Ｖ
	;PALAM:欲情をみる
	IF PALAM:奴隷:欲情 < PALAMLV:1
		TIMES LOCAL , 0.60
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:2
		TIMES LOCAL , 0.80
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:3
		TIMES LOCAL , 1.00
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:4
		TIMES LOCAL , 1.20
	ELSEIF PALAM:奴隷:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.50
	ENDIF
	;締り具合
	IF 締り具合名称(BASE:奴隷:Ｖ緩さ) == "きゅっきゅっ"
		TIMES LOCAL, 0.85
	ELSEIF 締り具合名称(BASE:奴隷:Ｖ緩さ) == "きゅうきゅう"
		TIMES LOCAL, 0.70
	ELSEIF 締り具合名称(BASE:奴隷:Ｖ緩さ) == "がばがば"
		TIMES LOCAL, 0.55
	ELSEIF 締り具合名称(BASE:奴隷:Ｖ緩さ) == "ぽっかり"
		TIMES LOCAL, 0.40
	ENDIF
	;ABL:欲望をみる
	LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:奴隷:欲望) / 100
	;小人体型
	IF TALENT:奴隷:体型 < -2
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 1.20
	ENDIF
	CUP:奴隷:快Ｖ += LOCAL
	CUP:奴隷:欲情 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_快Ａ(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;Ａ敏感とＡ鈍感はここで処理
	SOURCE:奴隷:快Ａ = SOURCE:奴隷:快Ａ * (2 + TALENT:奴隷:Ａ感度) / 2
	;A感覚
	SOURCE:奴隷:快Ａ = SOURCE:奴隷:快Ａ * SOURCE_REVISION1(ABL:奴隷:Ａ感覚) / 10
	;EXP:Ａ経験をみる
	IF EXP:奴隷:Ａ経験 < EXPLV:1
		TIMES SOURCE:奴隷:快Ａ , 0.30
	ELSEIF EXP:奴隷:Ａ経験 < EXPLV:2
		TIMES SOURCE:奴隷:快Ａ , 0.50
	ELSEIF EXP:奴隷:Ａ経験 < EXPLV:3
		TIMES SOURCE:奴隷:快Ａ , 0.80
	ELSEIF EXP:奴隷:Ａ経験 < EXPLV:4
		TIMES SOURCE:奴隷:快Ａ , 1.00
	ELSEIF EXP:奴隷:Ａ経験 < EXPLV:5
		TIMES SOURCE:奴隷:快Ａ , 1.20
	ELSEIF EXP:奴隷:Ａ経験 >= EXPLV:5
		TIMES SOURCE:奴隷:快Ａ , 1.50
	ENDIF
	;PALAM:潤滑をみる
	IF PALAM:奴隷:潤滑 < PALAMLV:1
		TIMES SOURCE:奴隷:快Ａ , 0.40
	ELSEIF PALAM:奴隷:潤滑 < PALAMLV:2
		TIMES SOURCE:奴隷:快Ａ , 0.60
	ELSEIF PALAM:奴隷:潤滑 < PALAMLV:3
		TIMES SOURCE:奴隷:快Ａ , 0.80
	ELSEIF PALAM:奴隷:潤滑 < PALAMLV:4
		TIMES SOURCE:奴隷:快Ａ , 0.90
	ELSEIF PALAM:奴隷:潤滑 >= PALAMLV:4
		TIMES SOURCE:奴隷:快Ａ , 1.00
	ENDIF
	LOCAL = SOURCE:奴隷:快Ａ
	LOCAL:1 = SOURCE:奴隷:快Ａ
	;PALAM:欲情をみる
	;快ＡはあまりPALAM:欲情では差が出ない
	IF PALAM:奴隷:欲情 < PALAMLV:1
		TIMES LOCAL , 0.90
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:2
		TIMES LOCAL , 1.00
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:3
		TIMES LOCAL , 1.10
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:4
		TIMES LOCAL , 1.20
	ELSEIF PALAM:奴隷:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.30
	ENDIF
	;締り具合
	IF 締り具合名称(BASE:奴隷:Ａ緩さ) == "きゅっきゅっ"
		TIMES LOCAL, 0.85
	ELSEIF 締り具合名称(BASE:奴隷:Ａ緩さ) == "きゅうきゅう"
		TIMES LOCAL, 0.70
	ELSEIF 締り具合名称(BASE:奴隷:Ａ緩さ) == "がばがば"
		TIMES LOCAL, 0.55
	ELSEIF 締り具合名称(BASE:奴隷:Ａ緩さ) == "ぽっかり"
		TIMES LOCAL, 0.40
	ENDIF
	;ABL:欲望をみる
	LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:奴隷:欲望) / 100
	;小人体型
	IF TALENT:奴隷:体型 < -2
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 1.50
	ENDIF
	;快Aのソースが0以上で処女で貞操観念のとき、屈服のソースを三分の一にする
	IF EXP:奴隷:Ｖ経験 == 0 && TALENT:奴隷:貞操 > 0 && SOURCE:奴隷:快Ａ > 0
		SOURCE:奴隷:屈従 /= 3
	ENDIF
	CUP:奴隷:快Ａ += LOCAL
	CUP:奴隷:欲情 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_快Ｂ(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;Ｂ敏感とＢ鈍感はここで処理
	SOURCE:奴隷:快Ｂ = SOURCE:奴隷:快Ｂ * (2 + TALENT:奴隷:Ｂ感度) / 2
	;B感覚
	SOURCE:奴隷:快Ｂ = SOURCE:奴隷:快Ｂ * SOURCE_REVISION1(ABL:奴隷:Ｂ感覚) / 10
	LOCAL = SOURCE:奴隷:快Ｂ
	;PALAM:欲情をみる
	IF PALAM:奴隷:欲情 < PALAMLV:1
		TIMES LOCAL , 0.80
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:2
		TIMES LOCAL , 1.00
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:3
		TIMES LOCAL , 1.20
	ELSEIF PALAM:奴隷:欲情 < PALAMLV:4
		TIMES LOCAL , 1.40
	ELSEIF PALAM:奴隷:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.60
	ENDIF
	CUP:奴隷:快Ｂ += LOCAL
	LOCAL = SOURCE:奴隷:快Ｂ
	;ABL:欲望をみる
	LOCAL = LOCAL * SOURCE_REVISION2(ABL:奴隷:欲望) / 100
	CUP:奴隷:欲情 += LOCAL

;-----------------------------------------------------
;与快CVAB
;-----------------------------------------------------
@SOURCE_与快Ｃ(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;Ｃ敏感とＣ鈍感はここで処理
	SOURCE:奴隷:与快Ｃ = SOURCE:奴隷:与快Ｃ * (2 + TALENT:主人:Ｃ感度) / 2
	;C感覚
	SOURCE:奴隷:与快Ｃ = SOURCE:奴隷:与快Ｃ * SOURCE_REVISION1(ABL:主人:Ｃ感覚) / 10
	LOCAL = SOURCE:奴隷:与快Ｃ
	;PALAM:欲情をみる
	IF PALAM:主人:欲情 < PALAMLV:1
		TIMES LOCAL , 0.80
	ELSEIF PALAM:主人:欲情 < PALAMLV:2
		TIMES LOCAL , 1.00
	ELSEIF PALAM:主人:欲情 < PALAMLV:3
		TIMES LOCAL , 1.20
	ELSEIF PALAM:主人:欲情 < PALAMLV:4
		TIMES LOCAL , 1.40
	ELSEIF PALAM:主人:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.60
	ENDIF
	CUP:主人:快Ｃ += LOCAL
	LOCAL = SOURCE:奴隷:与快Ｃ
	;ABL:欲望をみる
	LOCAL = LOCAL * SOURCE_REVISION2(ABL:主人:欲望) / 100
	CUP:主人:欲情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_与快Ｖ(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;Ｖ敏感とＶ鈍感はここで処理
	SOURCE:奴隷:与快Ｖ = SOURCE:奴隷:与快Ｖ * (2 + TALENT:主人:Ｖ感度) / 2
	;V感覚
	SOURCE:奴隷:与快Ｖ = SOURCE:奴隷:与快Ｖ * SOURCE_REVISION1(ABL:主人:Ｖ感覚) / 10
	;EXP:Ｖ経験をみる
	IF EXP:主人:Ｖ経験 < EXPLV:1
		TIMES SOURCE:奴隷:与快Ｖ , 0.30
	ELSEIF EXP:主人:Ｖ経験 < EXPLV:2
		TIMES SOURCE:奴隷:与快Ｖ , 0.50
	ELSEIF EXP:主人:Ｖ経験 < EXPLV:3
		TIMES SOURCE:奴隷:与快Ｖ , 0.80
	ELSEIF EXP:主人:Ｖ経験 < EXPLV:4
		TIMES SOURCE:奴隷:与快Ｖ , 1.00
	ELSEIF EXP:主人:Ｖ経験 < EXPLV:5
		TIMES SOURCE:奴隷:与快Ｖ , 1.20
	ELSEIF EXP:主人:Ｖ経験 >= EXPLV:5
		TIMES SOURCE:奴隷:与快Ｖ , 1.50
	ENDIF
	;PALAM:潤滑をみる
	IF PALAM:主人:潤滑 < PALAMLV:1
		TIMES SOURCE:奴隷:与快Ｖ , 0.10
	ELSEIF PALAM:主人:潤滑 < PALAMLV:2
		TIMES SOURCE:奴隷:与快Ｖ , 0.40
	ELSEIF PALAM:主人:潤滑 < PALAMLV:3
		TIMES SOURCE:奴隷:与快Ｖ , 0.60
	ELSEIF PALAM:主人:潤滑 < PALAMLV:4
		TIMES SOURCE:奴隷:与快Ｖ , 0.80
	ELSEIF PALAM:主人:潤滑 >= PALAMLV:4
		TIMES SOURCE:奴隷:与快Ｖ , 1.00
	ENDIF
	LOCAL = SOURCE:奴隷:与快Ｖ
	LOCAL:1 = SOURCE:奴隷:与快Ｖ
	;PALAM:欲情をみる
	IF PALAM:主人:欲情 < PALAMLV:1
		TIMES LOCAL , 0.60
	ELSEIF PALAM:主人:欲情 < PALAMLV:2
		TIMES LOCAL , 0.80
	ELSEIF PALAM:主人:欲情 < PALAMLV:3
		TIMES LOCAL , 1.00
	ELSEIF PALAM:主人:欲情 < PALAMLV:4
		TIMES LOCAL , 1.20
	ELSEIF PALAM:主人:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.50
	ENDIF
	;ABL:欲望をみる
	LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:主人:欲望) / 100
	;小人体型
	IF TALENT:主人:体型 < -2
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 1.20
	ENDIF
	CUP:主人:快Ｖ += LOCAL
	CUP:主人:欲情 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_与快Ａ(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;Ａ敏感とＡ鈍感はここで処理
	SOURCE:奴隷:与快Ａ = SOURCE:奴隷:与快Ａ * (2 + TALENT:主人:Ａ感度) / 2
	;A感覚
	SOURCE:奴隷:与快Ａ = SOURCE:奴隷:与快Ａ * SOURCE_REVISION1(ABL:主人:Ａ感覚) / 10
	;EXP:Ａ経験をみる
	IF EXP:主人:Ａ経験 < EXPLV:1
		TIMES SOURCE:奴隷:与快Ａ , 0.30
	ELSEIF EXP:主人:Ａ経験 < EXPLV:2
		TIMES SOURCE:奴隷:与快Ａ , 0.50
	ELSEIF EXP:主人:Ａ経験 < EXPLV:3
		TIMES SOURCE:奴隷:与快Ａ , 0.80
	ELSEIF EXP:主人:Ａ経験 < EXPLV:4
		TIMES SOURCE:奴隷:与快Ａ , 1.00
	ELSEIF EXP:主人:Ａ経験 < EXPLV:5
		TIMES SOURCE:奴隷:与快Ａ , 1.20
	ELSEIF EXP:主人:Ａ経験 >= EXPLV:5
		TIMES SOURCE:奴隷:与快Ａ , 1.50
	ENDIF
	;PALAM:潤滑をみる
	IF PALAM:主人:潤滑 < PALAMLV:1
		TIMES SOURCE:奴隷:与快Ａ , 0.40
	ELSEIF PALAM:主人:潤滑 < PALAMLV:2
		TIMES SOURCE:奴隷:与快Ａ , 0.60
	ELSEIF PALAM:主人:潤滑 < PALAMLV:3
		TIMES SOURCE:奴隷:与快Ａ , 0.80
	ELSEIF PALAM:主人:潤滑 < PALAMLV:4
		TIMES SOURCE:奴隷:与快Ａ , 0.90
	ELSEIF PALAM:主人:潤滑 >= PALAMLV:4
		TIMES SOURCE:奴隷:与快Ａ , 1.00
	ENDIF
	LOCAL = SOURCE:奴隷:与快Ａ
	LOCAL:1 = SOURCE:奴隷:与快Ａ
	;PALAM:欲情をみる
	;快ＡはあまりPALAM:欲情では差が出ない
	IF PALAM:主人:欲情 < PALAMLV:1
		TIMES LOCAL , 0.90
	ELSEIF PALAM:主人:欲情 < PALAMLV:2
		TIMES LOCAL , 1.00
	ELSEIF PALAM:主人:欲情 < PALAMLV:3
		TIMES LOCAL , 1.10
	ELSEIF PALAM:主人:欲情 < PALAMLV:4
		TIMES LOCAL , 1.20
	ELSEIF PALAM:主人:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.30
	ENDIF
	;ABL:欲望をみる
	LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:主人:欲望) / 100
	;小人体型
	IF TALENT:主人:体型 < -2
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 1.50
	ENDIF
	CUP:主人:快Ａ += LOCAL
	CUP:主人:欲情 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_与快Ｂ(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;Ｂ敏感とＢ鈍感はここで処理
	SOURCE:奴隷:与快Ｂ = SOURCE:奴隷:与快Ｂ * (2 + TALENT:主人:Ｂ感度) / 2
	;B感覚
	SOURCE:奴隷:与快Ｂ = SOURCE:奴隷:与快Ｂ * SOURCE_REVISION1(ABL:主人:Ｂ感覚) / 10
	LOCAL = SOURCE:奴隷:与快Ｂ
	;PALAM:欲情をみる
	IF PALAM:主人:欲情 < PALAMLV:1
		TIMES LOCAL , 0.80
	ELSEIF PALAM:主人:欲情 < PALAMLV:2
		TIMES LOCAL , 1.00
	ELSEIF PALAM:主人:欲情 < PALAMLV:3
		TIMES LOCAL , 1.20
	ELSEIF PALAM:主人:欲情 < PALAMLV:4
		TIMES LOCAL , 1.40
	ELSEIF PALAM:主人:欲情 >= PALAMLV:4
		TIMES LOCAL , 1.60
	ENDIF
	CUP:主人:快Ｂ += LOCAL
	LOCAL = SOURCE:奴隷:与快Ｂ
	;ABL:欲望をみる
	LOCAL = LOCAL * SOURCE_REVISION2(ABL:主人:欲望) / 100
	CUP:主人:欲情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_CVAB_EXTRA(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;-------------------------------------------------
	;気力０による上下の処理（快楽系）
	;-------------------------------------------------
	IF BASE:奴隷:気力 <= 0
		;UP:0,1,2,3は絶頂に絡むので先に処理してある
		CUP:奴隷:快Ｃ /= 2
		CUP:奴隷:快Ｖ /= 2
		CUP:奴隷:快Ａ /= 2
		CUP:奴隷:快Ｂ /= 2
	ENDIF
	;-------------------------------------------------
	;相性による上下の処理（快楽系）
	;-------------------------------------------------
	IF 主人 < CHARANUM && RELATION:奴隷:(NO:主人) != 0
		CUP:奴隷:快Ｃ *= RELATION:奴隷:(NO:主人)
		CUP:奴隷:快Ｃ /= 100
		CUP:奴隷:快Ｖ *= RELATION:奴隷:(NO:主人)
		CUP:奴隷:快Ｖ /= 100
		CUP:奴隷:快Ａ *= RELATION:奴隷:(NO:主人)
		CUP:奴隷:快Ａ /= 100
		CUP:奴隷:快Ｂ *= RELATION:奴隷:(NO:主人)
		CUP:奴隷:快Ｂ /= 100
	ENDIF
	;-------------------------------------------------
	;快感の否定は、快ソースの数値に応じて、抑鬱増加（淫乱で無効）
	;-------------------------------------------------
	SIF TALENT:奴隷:快感応答 < 0 && !TALENT:奴隷:淫乱
		SOURCE:奴隷:鬱屈 += (CUP:奴隷:快Ｃ + CUP:奴隷:快Ｖ + CUP:奴隷:快Ａ + CUP:奴隷:快Ｂ)/10
	;-------------------------------------------------
	;素質などによる上下の処理（快楽系）
	;-------------------------------------------------
	;媚薬
	IF TEQUIP:奴隷:媚薬
		TIMES CUP:奴隷:快Ｃ , 2.00
		TIMES CUP:奴隷:快Ｖ , 2.00
		TIMES CUP:奴隷:快Ａ , 2.00
		TIMES CUP:奴隷:快Ｂ , 2.00
	ENDIF
	;利尿剤
	IF TEQUIP:奴隷:利尿剤
		TIMES CUP:奴隷:快Ｃ , 0.70
		TIMES CUP:奴隷:快Ｖ , 0.70
		TIMES CUP:奴隷:快Ａ , 0.70
		TIMES CUP:奴隷:快Ｂ , 0.70
	ENDIF
	;-------------------------------------------------
	;陥落素質
	;-------------------------------------------------
	;淫乱
	IF TALENT:奴隷:淫乱
		TIMES CUP:奴隷:快Ｃ , 1.20
		TIMES CUP:奴隷:快Ｖ , 1.20
		TIMES CUP:奴隷:快Ａ , 1.20
		TIMES CUP:奴隷:快Ｂ , 1.20
	ENDIF
	;-------------------------------------------------
	;素質
	;-------------------------------------------------
	;自制心
	IF TALENT:奴隷:自制心
		TIMES CUP:奴隷:快Ｃ , 0.70
		TIMES CUP:奴隷:快Ｖ , 0.90
		TIMES CUP:奴隷:快Ａ , 1.00
		TIMES CUP:奴隷:快Ｂ , 0.70
	ENDIF
	;即落ち
	IF TALENT:奴隷:即落ち
		TIMES CUP:奴隷:快Ｃ , 2.00
		TIMES CUP:奴隷:快Ｖ , 2.00
		TIMES CUP:奴隷:快Ａ , 2.00
		TIMES CUP:奴隷:快Ｂ , 2.00
	ENDIF
	;自慰狂い
	SIF TALENT:奴隷:自慰狂い
		TIMES CUP:奴隷:快Ｃ , 1.20
	;淫壺
	SIF TALENT:奴隷:淫壺
		TIMES CUP:奴隷:快Ｖ , 1.20
	;尻穴狂い
	SIF TALENT:奴隷:尻穴狂い
		TIMES CUP:奴隷:快Ａ , 1.20
	;淫乳
	SIF TALENT:奴隷:淫乳
		TIMES CUP:奴隷:快Ｂ , 1.20
	;オトコ
	IF !(HAS_VAGINA(奴隷))
		TIMES CUP:奴隷:快Ａ , 1.30
	ENDIF
	;-------------------------------------------------
	;難易度による上下の処理（快楽系）
	;-------------------------------------------------
	CUP:奴隷:快Ｃ = CUP:奴隷:快Ｃ * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:快Ｖ = CUP:奴隷:快Ｖ * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:快Ａ = CUP:奴隷:快Ａ * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:快Ｂ = CUP:奴隷:快Ｂ * (16 - 4 * FLAG:難易度) / 10
	;-------------------------------------------------
	;愛液処理
	;-------------------------------------------------
	LOCAL:1 = CUP:奴隷:快Ｃ + CUP:奴隷:快Ｖ + CUP:奴隷:快Ａ + CUP:奴隷:快Ｂ
	;快Ｃ＋快Ｖ＋快Ａ＋快Ｂが合わせて100以上上昇ならその20%の液体のソースが加わる
	IF LOCAL:1 > 100
		;濡れやすいと濡れにくいはここで処理
		LOCAL:1 = LOCAL:1 * (10 + 5 * TALENT:奴隷:濡れやすさ) / 10
		SOURCE:奴隷:液体 += LOCAL:1 / 5
	ENDIF

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_情愛(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:情愛
	;ABL:従順をみる
	SELECTCASE ABL:奴隷:従順
		CASE 0
			TIMES LOCAL , 0.10
		CASE 1
			TIMES LOCAL , 0.50
		CASE 2
			TIMES LOCAL , 1.00
		CASE 3
			TIMES LOCAL , 1.50
		CASE 4
			TIMES LOCAL , 2.00
		CASE 5
			TIMES LOCAL , 2.50
		CASE 6
			TIMES LOCAL , 3.00
		CASE 7
			TIMES LOCAL , 3.50
		CASE 8
			TIMES LOCAL , 4.00
		CASE 9
			TIMES LOCAL , 5.00
		CASEELSE
			TIMES LOCAL , 6.00
	ENDSELECT
	CUP:奴隷:恭順 += LOCAL
	LOCAL = SOURCE:奴隷:情愛
	;欲望を見る
	SELECTCASE ABL:奴隷:欲望
		CASE 0
			TIMES LOCAL , 0.00
		CASE 1
			TIMES LOCAL , 0.40
		CASE 2
			TIMES LOCAL , 0.80
		CASE 3
			TIMES LOCAL , 1.20
		CASE 4
			TIMES LOCAL , 1.60
		CASE 5
			TIMES LOCAL , 2.00
		CASE 6
			TIMES LOCAL , 2.40
		CASE 7
			TIMES LOCAL , 2.80
		CASE 8
			TIMES LOCAL , 3.20
		CASE 9
			TIMES LOCAL , 3.60
		CASEELSE
			TIMES LOCAL , 5.00
	ENDSELECT
	CUP:奴隷:欲情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_性行動(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:性行動
	;ABL:技巧をみる
	SELECTCASE ABL:奴隷:技巧
		CASE 0
			TIMES LOCAL , 0.60
		CASE 1
			TIMES LOCAL , 1.20
		CASE 2
			TIMES LOCAL , 1.80
		CASE 3
			TIMES LOCAL , 2.40
		CASE 4
			TIMES LOCAL , 3.00
		CASE 5
			TIMES LOCAL , 3.60
		CASE 6
			TIMES LOCAL , 4.20
		CASE 7
			TIMES LOCAL , 4.80
		CASE 8
			TIMES LOCAL , 5.40
		CASE 9
			TIMES LOCAL , 6.00
		CASEELSE
			TIMES LOCAL , 7.00
	ENDSELECT
	;ABL:奉仕精神をみる
	SELECTCASE ABL:奴隷:奉仕精神
		CASE 0
			TIMES LOCAL , 0.60
		CASE 1
			TIMES LOCAL , 0.80
		CASE 2
			TIMES LOCAL , 1.00
		CASE 3
			TIMES LOCAL , 1.20
		CASE 4
			TIMES LOCAL , 1.40
		CASE 5
			TIMES LOCAL , 1.70
		CASE 6
			TIMES LOCAL , 2.00
		CASE 7
			TIMES LOCAL , 2.40
		CASE 8
			TIMES LOCAL , 2.80
		CASE 9
			TIMES LOCAL , 4.00
		CASEELSE
			TIMES LOCAL , 5.00
	ENDSELECT
	CUP:奴隷:習得 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_達成(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:達成
	;ABL:従順をみる
	SELECTCASE ABL:奴隷:従順
		CASE 0
			TIMES LOCAL , 0.50
		CASE 1
			TIMES LOCAL , 1.00
		CASE 2
			TIMES LOCAL , 1.50
		CASE 3
			TIMES LOCAL , 2.00
		CASE 4
			TIMES LOCAL , 2.50
		CASE 5
			TIMES LOCAL , 3.00
		CASE 6
			TIMES LOCAL , 3.50
		CASE 7
			TIMES LOCAL , 4.00
		CASE 8
			TIMES LOCAL , 4.50
		CASE 9
			TIMES LOCAL , 5.00
		CASEELSE
			TIMES LOCAL , 6.00
	ENDSELECT
	;ABL:奉仕精神をみる
	SELECTCASE ABL:奴隷:奉仕精神
		CASE 0
			TIMES LOCAL , 0.00
		CASE 1
			TIMES LOCAL , 0.50
		CASE 2
			TIMES LOCAL , 1.00
		CASE 3
			TIMES LOCAL , 1.50
		CASE 4
			TIMES LOCAL , 2.00
		CASE 5
			TIMES LOCAL , 2.50
		CASE 6
			TIMES LOCAL , 3.00
		CASE 7
			TIMES LOCAL , 3.50
		CASE 8
			TIMES LOCAL , 4.00
		CASE 9
			TIMES LOCAL , 4.50
		CASEELSE
			TIMES LOCAL , 6.00
	ENDSELECT
	CUP:奴隷:恭順 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_苦痛(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:苦痛
	LOCAL:1 = SOURCE:奴隷:苦痛
	LOCAL:2 = SOURCE:奴隷:苦痛 / 20
	;マゾっ気
	SELECTCASE ABL:奴隷:マゾっ気
		CASE 0
			TIMES LOCAL:1 , 0.00
		CASE 1
			TIMES LOCAL:1 , 0.10
		CASE 2
			TIMES LOCAL:1 , 0.20
		CASE 3
			TIMES LOCAL:1 , 0.30
		CASE 4
			TIMES LOCAL:1 , 0.45
		CASE 5
			TIMES LOCAL:1 , 0.60
		CASE 6
			TIMES LOCAL:1 , 0.75
		CASE 7
			TIMES LOCAL:1 , 0.90
		CASE 8
			TIMES LOCAL:1 , 1.20
		CASE 9
			TIMES LOCAL:1 , 1.50
		CASEELSE
			TIMES LOCAL:1 , 3.00
	ENDSELECT
	;小人体型
	IF TALENT:奴隷:体型 < -2
		TIMES LOCAL , 2.00
		TIMES LOCAL:1 , 0.75
	ENDIF
	;調教者が【サド】
	IF 主人 < CHARANUM && TALENT:主人:サド
		TIMES LOCAL:1 , 2.50
	ELSEIF 主人 == 人物_客 ;客は【サド】であると仮定
		TIMES LOCAL:1 , 2.50
	ELSEIF 主人 == 人物_訪問者 ;訪問者は【サド】であると仮定
		TIMES LOCAL:1 , 2.50
	ENDIF
	;臆病
	SIF TALENT:奴隷:度胸 < 0
		TIMES LOCAL:2 , 2.00
	;マゾっ気があるとPALAM:欲情も上がる
	;そのとき調教者が【サド】だと効果的
	;苦痛に応じて恐怖のソースが増加する
	CUP:奴隷:苦痛 += LOCAL
	CUP:奴隷:欲情 += LOCAL:1
	CUP:奴隷:恐怖 += LOCAL:2

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_恐怖(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL= SOURCE:奴隷:恐怖
	;ABL:従順をみる（恐怖よりは畏怖に近いと解釈）
	SELECTCASE ABL:奴隷:従順
		CASE 0
			TIMES LOCAL, 1.00
		CASE 1
			TIMES LOCAL, 1.50
		CASE 2
			TIMES LOCAL, 2.00
		CASE 3
			TIMES LOCAL, 2.50
		CASE 4
			TIMES LOCAL, 3.00
		CASE 5
			TIMES LOCAL, 3.50
		CASE 6
			TIMES LOCAL, 4.00
		CASE 7
			TIMES LOCAL, 4.50
		CASE 8
			TIMES LOCAL, 5.00
		CASE 9
			TIMES LOCAL, 5.50
		CASEELSE
			TIMES LOCAL, 7.00
	ENDSELECT
	CUP:奴隷:恐怖 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_液体(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:液体
	;小人体型
	IF TALENT:奴隷:体型 < -2
		SIF SELECTCOM != 50 && SELECTCOM != 180
			TIMES LOCAL , 0.40
	ENDIF
	CUP:奴隷:潤滑 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_欲情(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:欲情
	;欲望を見る
	SELECTCASE ABL:奴隷:欲望
		CASE 0
			TIMES LOCAL , 0.20
		CASE 1
			TIMES LOCAL , 0.40
		CASE 2
			TIMES LOCAL , 0.80
		CASE 3
			TIMES LOCAL , 1.20
		CASE 4
			TIMES LOCAL , 1.60
		CASE 5
			TIMES LOCAL , 2.00
		CASE 6
			TIMES LOCAL , 2.40
		CASE 7
			TIMES LOCAL , 2.80
		CASE 8
			TIMES LOCAL , 3.20
		CASE 9
			TIMES LOCAL , 3.60
		CASEELSE
			TIMES LOCAL , 5.00
	ENDSELECT
	CUP:奴隷:欲情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_恭順(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:恭順
	;ABL:従順をみる
	SELECTCASE ABL:奴隷:従順
		CASE 0
			TIMES LOCAL , 0.50
		CASE 0
			TIMES LOCAL , 0.80
		CASE 0
			TIMES LOCAL , 1.00
		CASE 0
			TIMES LOCAL , 1.20
		CASE 0
			TIMES LOCAL , 1.40
		CASE 0
			TIMES LOCAL , 1.60
		CASE 0
			TIMES LOCAL , 1.80
		CASE 0
			TIMES LOCAL , 2.00
		CASE 0
			TIMES LOCAL , 2.40
		CASE 0
			TIMES LOCAL , 3.00
		CASE 0
			TIMES LOCAL , 5.00
	ENDSELECT
	CUP:奴隷:恭順 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_露出(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;恥じらいと恥薄いはここで処理
	SIF TALENT:奴隷:羞恥心 > 0
		TIMES SOURCE:奴隷:露出 , 2.00
	SIF TALENT:奴隷:羞恥心 < 0
		TIMES SOURCE:奴隷:露出 , 0.50
	;潤滑アップの50％を露出のソースに加える
	;ただし液体追加のソースのぶんは引く
	SOURCE:奴隷:露出 += (CUP:奴隷:潤滑 - SOURCE:奴隷:液体) / 2
	LOCAL = SOURCE:奴隷:露出
	;ABL:露出癖をみる
	SELECTCASE ABL:奴隷:露出癖
		CASE 0
			TIMES LOCAL , 0.00
		CASE 1
			TIMES LOCAL , 0.10
		CASE 2
			TIMES LOCAL , 0.20
		CASE 3
			TIMES LOCAL , 0.40
		CASE 4
			TIMES LOCAL , 0.60
		CASE 5
			TIMES LOCAL , 0.80
		CASE 6
			TIMES LOCAL , 1.00
		CASE 7
			TIMES LOCAL , 1.20
		CASE 8
			TIMES LOCAL , 1.40
		CASE 9
			TIMES LOCAL , 1.60
		CASEELSE
			TIMES LOCAL , 2.00
	ENDSELECT
	CUP:奴隷:欲情 += LOCAL
	LOCAL = SOURCE:奴隷:露出
	;PALAM:恥情をみる
	;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
	IF PALAM:奴隷:恥情 < PALAMLV:1
		TIMES LOCAL , 1.00
	ELSEIF PALAM:奴隷:恥情 < PALAMLV:2
		TIMES LOCAL , 0.90
	ELSEIF PALAM:奴隷:恥情 < PALAMLV:3
		TIMES LOCAL , 0.80
	ELSEIF PALAM:奴隷:恥情 < PALAMLV:4
		TIMES LOCAL , 0.70
	ELSEIF PALAM:奴隷:恥情 >= PALAMLV:4
		TIMES LOCAL , 0.60
	ENDIF
	CUP:奴隷:恥情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_屈従(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:屈従
	;ABL:従順をみる
	SELECTCASE ABL:奴隷:従順
		CASE 0
			TIMES LOCAL , 0.50
		CASE 1
			TIMES LOCAL , 1.00
		CASE 2
			TIMES LOCAL , 1.50
		CASE 3
			TIMES LOCAL , 2.00
		CASE 4
			TIMES LOCAL , 2.50
		CASE 5
			TIMES LOCAL , 3.00
		CASE 6
			TIMES LOCAL , 3.50
		CASE 7
			TIMES LOCAL , 4.00
		CASE 8
			TIMES LOCAL , 4.50
		CASE 9
			TIMES LOCAL , 5.00
		CASEELSE
			TIMES LOCAL , 6.00
	ENDSELECT
	;ABL:奉仕精神をみる
	SELECTCASE ABL:奴隷:奉仕精神
		CASE 0
			TIMES LOCAL , 1.00
		CASE 1
			TIMES LOCAL , 1.50
		CASE 2
			TIMES LOCAL , 2.00
		CASE 3
			TIMES LOCAL , 2.50
		CASE 4
			TIMES LOCAL , 3.00
		CASE 5
			TIMES LOCAL , 3.50
		CASE 6
			TIMES LOCAL , 4.00
		CASE 7
			TIMES LOCAL , 4.50
		CASE 8
			TIMES LOCAL , 5.00
		CASE 9
			TIMES LOCAL , 5.50
		CASEELSE
			TIMES LOCAL , 7.00
	ENDSELECT
	CUP:奴隷:屈服 += LOCAL

;---------------------------------------------------
;PLAYERにも影響を与えるSOURCE
;---------------------------------------------------
@SOURCE_歓楽(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:歓楽
	;恋慕
	LOCAL = LOCAL * (10 + 5 * TALENT:奴隷:恋慕) / 10
	;ABL:親密をみる
	IF LOCAL < 100000
		LOCAL = LOCAL * (ABL:奴隷:親密 * 5 + 100) / 100
	ELSEIF LOCAL < 100000000
		LOCAL = LOCAL / 100 * (ABL:奴隷:親密 * 5 + 100)
	ENDIF
	;ABL:欲望をみる
	IF LOCAL < 100000
		LOCAL = LOCAL * (ABL:奴隷:欲望 * 5 + 100) / 100
	ELSEIF LOCAL < 100000000
		LOCAL = LOCAL / 100 * (ABL:奴隷:欲望 * 5 + 100)
	ENDIF
	;好感度を見る
	IF CFLAG:奴隷:好感度 <= 10
		TIMES LOCAL , 0.50
	ELSEIF CFLAG:奴隷:好感度 <= 50
		TIMES LOCAL , 0.80
	ELSEIF CFLAG:奴隷:好感度 <= 100
		TIMES LOCAL , 1.00
	ELSEIF CFLAG:奴隷:好感度 <= 300
		TIMES LOCAL , 1.10
	ELSEIF CFLAG:奴隷:好感度 <= 500
		TIMES LOCAL , 1.20
	ELSEIF CFLAG:奴隷:好感度 <= 700
		TIMES LOCAL , 1.30
	ELSEIF CFLAG:奴隷:好感度 <= 1000
		TIMES LOCAL , 1.40
	ELSEIF CFLAG:奴隷:好感度 <= 3000
		TIMES LOCAL , 1.50
	ELSEIF CFLAG:奴隷:好感度 <= 5000
		TIMES LOCAL , 1.70
	ELSEIF CFLAG:奴隷:好感度 <= 500000
		IF LOCAL < 100000
			LOCAL = LOCAL * (CFLAG:奴隷:好感度 / 50 + 100) / 100
		ELSEIF LOCAL < 10000000
			LOCAL = LOCAL / 100 * (CFLAG:奴隷:好感度 / 50 + 100)
		ELSEIF LOCAL < 100000000
			IF CFLAG:奴隷:好感度 <= 50000
				LOCAL = LOCAL / 100 * (CFLAG:奴隷:好感度 / 50 + 100)
			ELSE
				LOCAL = 1000000000
			ENDIF
		ENDIF
	ENDIF
	CUP:奴隷:好意 += LOCAL
	IF 主人 < CHARANUM
		CUP:主人:欲情 += MIN(LOCAL / 10 , 100)
	ENDIF

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_征服(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;地位で分岐
	IF 主人 < CHARANUM && CFLAG:奴隷:310 > CFLAG:主人:310
		;高位のキャラ
		LOCAL:1 = SOURCE:奴隷:征服 / 4
		;ABL:欲望をみる
		SELECTCASE ABL:奴隷:欲望
			CASE 0
				TIMES LOCAL:1 , 0.10
			CASE 1
				TIMES LOCAL:1 , 0.15
			CASE 2
				TIMES LOCAL:1 , 0.20
			CASE 3
				TIMES LOCAL:1 , 0.25
			CASE 4
				TIMES LOCAL:1 , 0.30
			CASEELSE
				IF LOCAL:1 < 100000
					LOCAL:1 = LOCAL:1 * (ABL:奴隷:欲望 * 5 + 15) / 100
				ELSEIF LOCAL:1 < 100000000
					LOCAL:1 = LOCAL:1 / 100 * (ABL:奴隷:欲望 * 5 + 15)
				ENDIF
		ENDSELECT
		;ABL:サドっ気をみる
		IF LOCAL:1 < 100000
			LOCAL:1 = LOCAL:1 * (ABL:奴隷:サドっ気 * 30 + 100) / 100
		ELSEIF LOCAL:1 < 100000000
			LOCAL:1 = LOCAL:1 / 100 * (ABL:奴隷:サドっ気 * 30 + 100)
		ENDIF
	ELSE
		;低位のキャラ
		LOCAL:2 = SOURCE:奴隷:征服 / 2
		;ABL:親密をみる
		SELECTCASE ABL:奴隷:親密
			CASE 0
				TIMES LOCAL:2 , 0.10
			CASE 1
				TIMES LOCAL:2 , 0.15
			CASE 2
				TIMES LOCAL:2 , 0.20
			CASE 3
				TIMES LOCAL:2 , 0.25
			CASE 4
				TIMES LOCAL:2 , 0.30
			CASEELSE
				IF LOCAL:2 < 100000
					LOCAL:2 = LOCAL:2 * (ABL:奴隷:親密 * 5 + 15) / 100
				ELSEIF LOCAL:2 < 100000000
					LOCAL:2 = LOCAL:2 / 100 * (ABL:奴隷:親密 * 5 + 15)
				ENDIF
		ENDSELECT
	ENDIF
	LOCAL = SOURCE:奴隷:征服
	;ABL:サドっ気をみる
	SELECTCASE ABL:奴隷:サドっ気
		CASE 0
			TIMES LOCAL , 0.70
		CASE 1
			TIMES LOCAL , 1.00
		CASE 2
			TIMES LOCAL , 1.30
		CASE 3
			TIMES LOCAL , 1.70
		CASE 4
			TIMES LOCAL , 2.00
		CASEELSE
			IF LOCAL < 100000
				LOCAL = LOCAL * (ABL:奴隷:サドっ気 * 15 + 175) / 100
			ELSEIF LOCAL < 100000000
				LOCAL = LOCAL / 100 * (ABL:奴隷:サドっ気 * 15 + 175)
			ENDIF
	ENDSELECT
	CUP:奴隷:優越 += LOCAL
	CUP:奴隷:欲情 += LOCAL:1
	IF 主人 < CHARANUM
		CUP:主人:屈服 += LOCAL:1
	ENDIF
	CUP:奴隷:恥情 += LOCAL:2

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_受動(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	IF 主人 > CHARANUM || CFLAG:奴隷:310 > CFLAG:主人:310
		;高位のキャラ
		LOCAL:1 = SOURCE:奴隷:受動 / 3
		;ABL:欲望をみる
		SELECTCASE ABL:奴隷:欲望
			CASE 0
				TIMES LOCAL:1 , 0.30
			CASE 1
				TIMES LOCAL:1 , 0.35
			CASE 2
				TIMES LOCAL:1 , 0.40
			CASE 3
				TIMES LOCAL:1 , 0.45
			CASE 4
				TIMES LOCAL:1 , 0.50
			CASEELSE
				IF LOCAL:1 < 100000
					LOCAL:1 = LOCAL:1 * (ABL:奴隷:欲望 * 10 + 10) / 100
				ELSEIF LOCAL:1 < 100000000
					LOCAL:1 = LOCAL:1 / 100 * (ABL:奴隷:欲望 * 10 + 10)
				ENDIF
		ENDSELECT
	ELSE
		LOCAL:2 = SOURCE:奴隷:受動 / 2
		;ABL:奉仕精神をみる
		SELECTCASE ABL:奴隷:奉仕精神
			CASE 0
				TIMES LOCAL:2 , 0.30
			CASE 1
				TIMES LOCAL:2 , 0.35
			CASE 2
				TIMES LOCAL:2 , 0.40
			CASE 3
				TIMES LOCAL:2 , 0.45
			CASE 4
				TIMES LOCAL:2 , 0.50
			CASEELSE
				IF LOCAL:2 < 100000
					LOCAL:2 = LOCAL:2 * (ABL:奴隷:奉仕精神 * 10 + 10) / 100
				ELSEIF LOCAL:2 < 100000000
					LOCAL:2 = LOCAL:2 / 100 * (ABL:奴隷:奉仕精神 * 10 + 10)
				ENDIF
		ENDSELECT
	ENDIF
	LOCAL = SOURCE:奴隷:受動
	;ABL:親密をみる
	IF LOCAL < 100000
		LOCAL = LOCAL * (ABL:奴隷:親密 * 10 + 70) / 100
	ELSEIF LOCAL < 100000000
		LOCAL = LOCAL / 100 * (ABL:奴隷:親密 * 10 + 70)
	ENDIF
	CUP:奴隷:好意 += LOCAL
	CUP:奴隷:屈服 += LOCAL:1
	IF 主人 < CHARANUM
		CUP:主人:恭順 += LOCAL:1
	ENDIF
	CUP:奴隷:恭順 += LOCAL:2

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_誘惑(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	SOURCE:奴隷:誘惑 = SOURCE:奴隷:誘惑 * GET_REVISION(ABL:奴隷:欲望 + 2, 500, 10) / 100
	LOCAL = SOURCE:奴隷:誘惑
	LOCAL:1 = SOURCE:奴隷:誘惑
	LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:欲望, 500, 20)) / 100
	CUP:主人:欲情 += LOCAL
	LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:主人:従順, 500, 5)) / 100
	CUP:主人:恭順 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_辱め(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	SOURCE:奴隷:辱め = SOURCE:奴隷:辱め * GET_REVISION(ABL:奴隷:サドっ気 + 2, 500, 10) / 100
	LOCAL = SOURCE:奴隷:辱め
	LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:マゾっ気, 500, 20)) / 100
	LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:露出癖, 500, 20)) / 100
	;PALAM:恥情をみる
	;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
	IF PALAM:主人:恥情 < PALAMLV:1
		TIMES LOCAL , 1.00
	ELSEIF PALAM:主人:恥情 < PALAMLV:2
		TIMES LOCAL , 0.90
	ELSEIF PALAM:主人:恥情 < PALAMLV:3
		TIMES LOCAL , 0.80
	ELSEIF PALAM:主人:恥情 < PALAMLV:4
		TIMES LOCAL , 0.70
	ELSEIF PALAM:主人:恥情 >= PALAMLV:4
		TIMES LOCAL , 0.60
	ENDIF
	CUP:主人:恥情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_挑発(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	SOURCE:奴隷:挑発 = SOURCE:奴隷:挑発 * GET_REVISION(ABL:奴隷:サドっ気 + 2, 500, 10) / 100
	LOCAL = SOURCE:奴隷:挑発
	LOCAL:1 = SOURCE:奴隷:挑発
	LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:欲望, 500, 10)) / 100
	CUP:主人:欲情 += LOCAL
	LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:主人:マゾっ気, 500, 5)) / 100
	CUP:主人:屈服 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_奉仕(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	SOURCE:奴隷:奉仕 = SOURCE:奴隷:奉仕 * GET_REVISION(ABL:奴隷:技巧 + ABL:奴隷:奉仕精神 + 2, 500, 10) / 100
	LOCAL = SOURCE:奴隷:奉仕
	LOCAL:1 = SOURCE:奴隷:奉仕
	LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:欲望, 500, 10)) / 100
	CUP:主人:欲情 += LOCAL
	LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:主人:マゾっ気, 500, 5)) / 100
	CUP:主人:屈服 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_強要(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	SOURCE:奴隷:強要 = SOURCE:奴隷:強要 * GET_REVISION(ABL:奴隷:サドっ気 +ABL:奴隷:欲望 + 2, 500, 10) / 100
	LOCAL = SOURCE:奴隷:強要
	LOCAL:1 = SOURCE:奴隷:強要
	LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:奉仕精神, 500, 5)) / 100
	CUP:主人:恭順 += LOCAL
	LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:主人:従順, 500, 10)) / 100
	CUP:主人:屈服 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_加虐(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	SOURCE:奴隷:加虐 = SOURCE:奴隷:加虐 * GET_REVISION(ABL:奴隷:サドっ気 + ABL:奴隷:欲望 + 2, 500, 5) / 100
	LOCAL = SOURCE:奴隷:加虐
	LOCAL:1 = SOURCE:奴隷:加虐
	LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:マゾっ気, 500, 10)) / 100
	CUP:主人:苦痛 += LOCAL
	LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:マゾっ気, 500, 5)) / 100
	CUP:主人:恐怖 += LOCAL
	LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:主人:従順, 500, 10)) / 100
	CUP:主人:屈服 += LOCAL:1

;---------------------------------------------------
;マイナスSOURCE
;---------------------------------------------------
@SOURCE_不潔(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:不潔
	;ABL:従順をみる
	SELECTCASE ABL:奴隷:従順
		CASE 0
			TIMES LOCAL , 1.00
		CASE 1
			TIMES LOCAL , 0.90
		CASE 2
			TIMES LOCAL , 0.80
		CASE 3
			TIMES LOCAL , 0.70
		CASE 4
			TIMES LOCAL , 0.60
		CASE 5
			TIMES LOCAL , 0.50
		CASE 6
			TIMES LOCAL , 0.40
		CASE 7
			TIMES LOCAL , 0.30
		CASE 8
			TIMES LOCAL , 0.20
		CASE 9
			TIMES LOCAL , 0.10
		CASEELSE
			TIMES LOCAL , 0.00
	ENDSELECT
	;鍵を持っていると不快低下
	IF FLAG:貞操帯鍵購入フラグ == 奴隷
		TIMES LOCAL , 0.20
	ENDIF	
	CUP:奴隷:不快 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_鬱屈(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:鬱屈
	;ABL:従順をみる
	SELECTCASE ABL:奴隷:従順
		CASE 0
			TIMES LOCAL , 1.00
		CASE 1
			TIMES LOCAL , 0.80
		CASE 2
			TIMES LOCAL , 0.60
		CASE 3
			TIMES LOCAL , 0.40
		CASE 4
			TIMES LOCAL , 0.30
		CASE 5
			TIMES LOCAL , 0.20
		CASE 6
			TIMES LOCAL , 0.10
		CASE 7
			TIMES LOCAL , 0.08
		CASE 8
			TIMES LOCAL , 0.06
		CASE 9
			TIMES LOCAL , 0.04
		CASEELSE
			TIMES LOCAL , 0.00
	ENDSELECT
	;ABL:欲望をみる
	SELECTCASE ABL:奴隷:欲望
		CASE 0
			TIMES LOCAL , 1.00
		CASE 1
			TIMES LOCAL , 0.90
		CASE 2
			TIMES LOCAL , 0.80
		CASE 3
			TIMES LOCAL , 0.70
		CASE 4
			TIMES LOCAL , 0.60
		CASE 5
			TIMES LOCAL , 0.50
		CASE 6
			TIMES LOCAL , 0.40
		CASE 7
			TIMES LOCAL , 0.30
		CASE 8
			TIMES LOCAL , 0.20
		CASE 9
			TIMES LOCAL , 0.10
		CASEELSE
			TIMES LOCAL , 0.00
	ENDSELECT
	CUP:奴隷:抑鬱 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_逸脱(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;好奇心と保守的はここで処理
	SIF TALENT:奴隷:性的興味 > 0
		TIMES SOURCE:奴隷:逸脱 , 0.80
	SIF TALENT:奴隷:性的興味 < 0
		TIMES SOURCE:奴隷:逸脱 , 2.00
	LOCAL = SOURCE:奴隷:逸脱
	;ABL:従順をみる
	SELECTCASE ABL:奴隷:従順
		CASE 0
			TIMES LOCAL , 1.00
		CASE 1
			TIMES LOCAL , 0.80
		CASE 2
			TIMES LOCAL , 0.60
		CASE 3
			TIMES LOCAL , 0.40
		CASE 4
			TIMES LOCAL , 0.30
		CASE 5
			TIMES LOCAL , 0.20
		CASE 6
			TIMES LOCAL , 0.10
		CASE 7
			TIMES LOCAL , 0.08
		CASE 8
			TIMES LOCAL , 0.06
		CASE 9
			TIMES LOCAL , 0.04
		CASEELSE
			TIMES LOCAL , 0.00
	ENDSELECT
	;ABL:マゾっ気をみる
	SELECTCASE ABL:奴隷:マゾっ気
		CASE 0
			TIMES LOCAL , 1.00
		CASE 1
			TIMES LOCAL , 0.90
		CASE 2
			TIMES LOCAL , 0.80
		CASE 3
			TIMES LOCAL , 0.70
		CASE 4
			TIMES LOCAL , 0.60
		CASE 5
			TIMES LOCAL , 0.50
		CASE 6
			TIMES LOCAL , 0.40
		CASE 7
			TIMES LOCAL , 0.30
		CASE 8
			TIMES LOCAL , 0.20
		CASE 9
			TIMES LOCAL , 0.10
		CASEELSE
			TIMES LOCAL , 0.00
	ENDSELECT
	;鍵を持っていると減少
	IF FLAG:貞操帯鍵購入フラグ == 奴隷
		TIMES LOCAL , 0.20
	ENDIF	
	CUP:奴隷:反感 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_反感(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	LOCAL = SOURCE:奴隷:反感
	;ABL:従順をみる
	LOCAL:1 = ABL:奴隷:従順 + ABL:奴隷:親密
	SELECTCASE LOCAL:1
		CASE 0
			TIMES LOCAL , 1.00
		CASE 1
			TIMES LOCAL , 0.80
		CASE 2
			TIMES LOCAL , 0.60
		CASE 3
			TIMES LOCAL , 0.40
		CASE 4
			TIMES LOCAL , 0.30
		CASE 5
			TIMES LOCAL , 0.20
		CASE 6
			TIMES LOCAL , 0.10
		CASE 7
			TIMES LOCAL , 0.08
		CASE 8
			TIMES LOCAL , 0.06
		CASE 9
			TIMES LOCAL , 0.04
		CASEELSE
			TIMES LOCAL , 0.00
	ENDSELECT
	;ABL:奉仕精神をみる
	SELECTCASE ABL:奴隷:奉仕精神
		CASE 0
			TIMES LOCAL , 1.00
		CASE 1
			TIMES LOCAL , 0.90
		CASE 2
			TIMES LOCAL , 0.80
		CASE 3
			TIMES LOCAL , 0.70
		CASE 4
			TIMES LOCAL , 0.60
		CASE 5
			TIMES LOCAL , 0.50
		CASE 6
			TIMES LOCAL , 0.40
		CASE 7
			TIMES LOCAL , 0.30
		CASE 8
			TIMES LOCAL , 0.20
		CASE 9
			TIMES LOCAL , 0.10
		CASEELSE
			TIMES LOCAL , 0.00
	ENDSELECT
	;ABL:マゾっ気をみる
	SELECTCASE ABL:奴隷:マゾっ気
		CASE 0
			TIMES LOCAL , 1.00
		CASE 1
			TIMES LOCAL , 0.90
		CASE 2
			TIMES LOCAL , 0.80
		CASE 3
			TIMES LOCAL , 0.70
		CASE 4
			TIMES LOCAL , 0.60
		CASE 5
			TIMES LOCAL , 0.50
		CASE 6
			TIMES LOCAL , 0.40
		CASE 7
			TIMES LOCAL , 0.30
		CASE 8
			TIMES LOCAL , 0.20
		CASE 9
			TIMES LOCAL , 0.10
		CASEELSE
			TIMES LOCAL , 0.00
	ENDSELECT
	;鍵を持っていると減少
	IF FLAG:貞操帯鍵購入フラグ == 奴隷
		TIMES LOCAL , 0.20
	ENDIF	
	CUP:奴隷:反感 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_EXTRA(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	VARSET LOCAL
	;-------------------------------------------------
	;装備系（薬等）
	;-------------------------------------------------
	;媚薬
	IF TEQUIP:奴隷:媚薬
		TIMES CUP:奴隷:恭順 , 1.20
		TIMES CUP:奴隷:欲情 , 2.00
		TIMES CUP:奴隷:屈服 , 1.20
		TIMES CUP:奴隷:不快 , 0.75
	ENDIF
	;利尿剤
	IF TEQUIP:奴隷:利尿剤
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:欲情 , 0.80
		TIMES CUP:奴隷:恥情 , 1.20
		TIMES CUP:奴隷:反感 , 1.50
		TIMES CUP:奴隷:不快 , 1.20
	ENDIF
	;鍵を持っていると減少
	IF FLAG:貞操帯鍵購入フラグ == 奴隷
		TIMES CUP:奴隷:反感 , 0.20
		TIMES CUP:奴隷:不快 , 0.20
	ENDIF	
	;-------------------------------------------------
	;陥落素質
	;-------------------------------------------------
	;恋慕
	IF TALENT:奴隷:恋慕 && ASSIPLAY == 0
		CUP:奴隷:恭順 = CUP:奴隷:恭順 * (10 + 5 * TALENT:奴隷:恋慕) / 10
		CUP:奴隷:屈服 = CUP:奴隷:屈服 * (10 + 5 * TALENT:奴隷:恋慕) / 10
		SIF CUP:奴隷:好意 < 999999999
			CUP:奴隷:好意 = CUP:奴隷:好意 * (10 + 5 * TALENT:奴隷:恋慕) / 10
		CUP:奴隷:反感 = CUP:奴隷:反感 * (10 - 4 * TALENT:奴隷:恋慕) / 10
		CUP:奴隷:不快 = CUP:奴隷:不快 * (10 - 4 * TALENT:奴隷:恋慕) / 10
		TIMES CUP:奴隷:抑鬱 , 0.50
	ELSEIF TALENT:奴隷:恋慕 && ASSIPLAY > 0
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
		TIMES CUP:奴隷:不快 , 1.20
	ENDIF
	;淫乱
	IF TALENT:奴隷:淫乱
		CUP:奴隷:恭順 = CUP:奴隷:恭順 * (10 + 2 * TALENT:奴隷:淫乱) / 10
		CUP:奴隷:屈服 = CUP:奴隷:屈服 * (10 + 2 * TALENT:奴隷:淫乱) / 10
		CUP:奴隷:反感 = CUP:奴隷:反感 * (10 - 2 * TALENT:奴隷:淫乱) / 10
		CUP:奴隷:不快 = CUP:奴隷:不快 * (10 - 2 * TALENT:奴隷:淫乱) / 10
		TIMES CUP:奴隷:抑鬱 , 0.40
	ENDIF
	;-------------------------------------------------
	;素質
	;-------------------------------------------------
	;気丈
	IF TALENT:奴隷:度胸 > 0
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:欲情 , 0.80
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:恐怖 , 0.80
		TIMES CUP:奴隷:好意 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
		TIMES CUP:奴隷:抑鬱 , 1.20
	ENDIF
	;臆病
	IF TALENT:奴隷:度胸 < 0
		TIMES CUP:奴隷:恐怖 , 1.20
		TIMES CUP:奴隷:反感 , 1.20
	ENDIF
	;反抗的（服従、隷属で無効）
	IF TALENT:奴隷:態度 > 0 && !TALENT:奴隷:服従
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:好意 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
	ENDIF
	;素直
	IF TALENT:奴隷:態度 < 0
		TIMES CUP:奴隷:恭順 , 1.20
		TIMES CUP:奴隷:反感 , 0.80
		SIF CUP:奴隷:好意 < 999999999
			TIMES CUP:奴隷:好意 , 1.50
	ENDIF
	;生意気
	IF TALENT:奴隷:応答 > 0
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
	ENDIF
	;大人しい
	IF TALENT:奴隷:応答 < 0
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:反感 , 0.80
	ENDIF
	;プライド高い
	IF TALENT:奴隷:プライド > 0
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:恐怖 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
	ENDIF
	;プライド低い
	IF TALENT:奴隷:プライド < 0
		TIMES CUP:奴隷:屈服 , 1.20
		TIMES CUP:奴隷:恐怖 , 1.20
		TIMES CUP:奴隷:反感 , 0.80
	ENDIF
	;ツンデレ
	IF TALENT:奴隷:ツンデレ
		;陥落素質がある場合と無い場合で変化する
		IF TALENT:奴隷:恋慕 || TALENT:奴隷:淫乱 || TALENT:奴隷:服従
			TIMES CUP:奴隷:恭順 , 1.20
			TIMES CUP:奴隷:屈服 , 1.20
			TIMES CUP:奴隷:反感 , 0.80
		ELSE
			TIMES CUP:奴隷:恭順 , 0.80
			TIMES CUP:奴隷:屈服 , 0.80
			TIMES CUP:奴隷:反感 , 1.20
		ENDIF
	ENDIF
	;自制心
	IF TALENT:奴隷:自制心
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:恐怖 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
	ENDIF
	;無関心
	IF TALENT:奴隷:無関心
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:欲情 , 0.80
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:好意 , 0.80
		TIMES CUP:奴隷:恐怖 , 0.80
		TIMES CUP:奴隷:反感 , 0.80
	ENDIF
	;感情乏しい
	IF TALENT:奴隷:感情乏しい
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:欲情 , 0.80
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:恥情 , 0.80
		TIMES CUP:奴隷:恐怖 , 0.80
		TIMES CUP:奴隷:好意 , 0.80
		TIMES CUP:奴隷:反感 , 0.80
		TIMES CUP:奴隷:不快 , 0.80
		TIMES CUP:奴隷:抑鬱 , 0.80
	ENDIF
	;好奇心
	SIF TALENT:奴隷:性的興味 > 0
		TIMES CUP:奴隷:習得 , 1.20
	;保守的
	SIF TALENT:奴隷:性的興味 < 0
		TIMES CUP:奴隷:習得 , 0.80
	;楽観的
	SIF TALENT:奴隷:陽気／陰気 > 0
		TIMES CUP:奴隷:抑鬱 , 0.80
	;悲観的
	SIF TALENT:奴隷:陽気／陰気 < 0
		TIMES CUP:奴隷:抑鬱 , 1.20
	;目立ちたがり
	SIF TALENT:奴隷:目立ちたがり
		TIMES CUP:奴隷:恭順 , 1.20
	;抑圧
	IF TALENT:奴隷:自己愛 < 0
		TIMES CUP:奴隷:欲情 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
		TIMES CUP:奴隷:抑鬱 , 1.20
	ENDIF
	;解放
	IF TALENT:奴隷:自己愛 > 0
		TIMES CUP:奴隷:欲情 , 1.20
		TIMES CUP:奴隷:屈服 , 1.20
	ENDIF
	;抵抗
	IF TALENT:奴隷:抵抗
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
		TIMES CUP:奴隷:抑鬱 , 1.20
	ENDIF
	;痛覚
	CUP:奴隷:苦痛 = CUP:奴隷:苦痛 * (10 + 2 * TALENT:奴隷:痛覚) / 10
	;習得速度
	CUP:奴隷:習得 = CUP:奴隷:習得 * (10 + 2 * TALENT:奴隷:習得速度) / 10
	;献身的
	SIF TALENT:奴隷:献身的
		TIMES CUP:奴隷:屈服 , 1.20
	;快感に素直
	SIF TALENT:奴隷:快感応答 > 0
		TIMES CUP:奴隷:欲情 , 1.20
	;快感の否定（淫乱、娼婦で無効）
	SIF TALENT:奴隷:快感応答 < 0 && !TALENT:奴隷:淫乱
		TIMES CUP:奴隷:欲情 , 0.80
	;即落ち
	IF TALENT:奴隷:即落ち
		TIMES CUP:奴隷:恭順 , 2.00
		TIMES CUP:奴隷:欲情 , 2.00
		TIMES CUP:奴隷:屈服 , 2.00
		TIMES CUP:奴隷:習得 , 2.00
		TIMES CUP:奴隷:恥情 , 2.00
		TIMES CUP:奴隷:恐怖 , 2.00
		TIMES CUP:奴隷:反感 , 0.50
		TIMES CUP:奴隷:不快 , 0.50
		TIMES CUP:奴隷:抑鬱 , 0.50
	ENDIF
	;自慰狂い
	SIF TALENT:奴隷:自慰狂い
		TIMES CUP:奴隷:欲情 , 1.20
	;淫壺
	SIF TALENT:奴隷:淫壺
		TIMES CUP:奴隷:恭順 , 1.20
	;尻穴狂い
	SIF TALENT:奴隷:尻穴狂い
		TIMES CUP:奴隷:屈服 , 1.20
	;淫乳
	SIF TALENT:奴隷:淫乳
		TIMES CUP:奴隷:恥情 , 1.20
	;倒錯的
	IF TALENT:奴隷:倒錯的
		TIMES CUP:奴隷:屈服 , 1.20
		TIMES CUP:奴隷:恥情 , 1.20
	ENDIF
	;男嫌い（女性のみ恋慕、親愛で無効）
	IF TALENT:奴隷:性別嗜好 & 1 && !(HAS_VAGINA(PLAYER)) && (!TALENT:奴隷:恋慕 || PLAYER != MASTER)
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:欲情 , 0.80
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:習得 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
		TIMES CUP:奴隷:不快 , 1.20
	ENDIF
	;サド
	IF TALENT:奴隷:サド
		TIMES CUP:奴隷:優越 , 2.00
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:恐怖 , 0.80
	ENDIF
	;マゾ
	IF TALENT:奴隷:マゾ
		TIMES CUP:奴隷:屈服 , 1.20
		TIMES CUP:奴隷:恐怖 , 1.20
		TIMES CUP:奴隷:抑鬱 , 0.80
	ENDIF
	IF TALENT:奴隷:小悪魔
		TIMES CUP:奴隷:優越 , 1.50
	ENDIF
	;妄信
	IF TALENT:奴隷:妄信
		TIMES CUP:奴隷:屈服 , 1.20
		TIMES CUP:奴隷:反感 , 0.80
	ENDIF
	;女嫌い（男性のみ恋慕、親愛で無効）
	IF TALENT:奴隷:性別嗜好 & 2 && (HAS_VAGINA(PLAYER)) && (!TALENT:奴隷:恋慕 || PLAYER != MASTER )
		TIMES CUP:奴隷:恭順 , 0.80
		TIMES CUP:奴隷:欲情 , 0.80
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:習得 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
		TIMES CUP:奴隷:不快 , 1.20
	ENDIF
	;-------------------------------------------------
	;その他
	;-------------------------------------------------
	;苦痛刻印
	IF MARK:奴隷:苦痛刻印 == 3
		TIMES CUP:奴隷:苦痛 , 1.30
		TIMES CUP:奴隷:恐怖 , 1.30
	ELSEIF MARK:奴隷:苦痛刻印 == 2
		TIMES CUP:奴隷:苦痛 , 1.20
		TIMES CUP:奴隷:恐怖 , 1.20
	ELSEIF MARK:奴隷:苦痛刻印 == 1
		TIMES CUP:奴隷:苦痛 , 1.10
		TIMES CUP:奴隷:恐怖 , 1.10
	ENDIF
	;快楽刻印
	IF MARK:奴隷:快楽刻印 == 3
		TIMES CUP:奴隷:欲情 , 1.30
		TIMES CUP:奴隷:習得 , 1.30
	ELSEIF MARK:奴隷:快楽刻印 == 2
		TIMES CUP:奴隷:欲情 , 1.20
		TIMES CUP:奴隷:習得 , 1.20
	ELSEIF MARK:奴隷:快楽刻印 == 1
		TIMES CUP:奴隷:欲情 , 1.10
		TIMES CUP:奴隷:習得 , 1.10
	ENDIF
	;屈服刻印
	IF MARK:奴隷:屈服刻印 == 3
		TIMES CUP:奴隷:恭順 , 1.30
		TIMES CUP:奴隷:屈服 , 1.30
	ELSEIF MARK:奴隷:屈服刻印 == 2
		TIMES CUP:奴隷:恭順 , 1.20
		TIMES CUP:奴隷:屈服 , 1.20
	ELSEIF MARK:奴隷:屈服刻印 == 1
		TIMES CUP:奴隷:恭順 , 1.10
		TIMES CUP:奴隷:屈服 , 1.10
	ENDIF
	;反発刻印
	IF MARK:奴隷:反発刻印 == 3
		TIMES CUP:奴隷:恭順 , 0.10
		TIMES CUP:奴隷:反感 , 1.30
	ELSEIF MARK:奴隷:反発刻印 == 2
		TIMES CUP:奴隷:恭順 , 0.40
		TIMES CUP:奴隷:反感 , 1.20
	ELSEIF MARK:奴隷:反発刻印 == 1
		TIMES CUP:奴隷:恭順 , 0.60
		TIMES CUP:奴隷:反感 , 1.10
	ENDIF
	;-------------------------------------------------
	;難易度などによる上下の処理
	;-------------------------------------------------
	CUP:奴隷:潤滑 = CUP:奴隷:潤滑 * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:恭順 = CUP:奴隷:恭順 * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:欲情 = CUP:奴隷:欲情 * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:屈服 = CUP:奴隷:屈服 * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:習得 = CUP:奴隷:習得 * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:恥情 = CUP:奴隷:恥情 * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:苦痛 = CUP:奴隷:苦痛 * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:恐怖 = CUP:奴隷:恐怖 * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:好意 = CUP:奴隷:好意 * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:優越 = CUP:奴隷:優越 * (16 - 4 * FLAG:難易度) / 10
	CUP:奴隷:反感 = CUP:奴隷:反感 * (8 +  4 * FLAG:難易度) / 10
	CUP:奴隷:不快 = CUP:奴隷:不快 * (8 + 4 * FLAG:難易度) / 10
	CUP:奴隷:抑鬱 = CUP:奴隷:抑鬱 * (8 + 4 * FLAG:難易度) / 10
	;-------------------------------------------------
	;相性による上下の処理
	;-------------------------------------------------
	IF 主人 < CHARANUM && RELATION:奴隷:(NO:主人) != 0
		CUP:奴隷:欲情 *= RELATION:奴隷:(NO:主人)
		CUP:奴隷:欲情 /= 100
		CUP:奴隷:屈服 *= RELATION:奴隷:(NO:主人)
		CUP:奴隷:屈服 /= 100
		CUP:奴隷:恥情 *= RELATION:奴隷:(NO:主人)
		CUP:奴隷:恥情 /= 100
		CUP:奴隷:反感 *= 100
		CUP:奴隷:反感 /= RELATION:奴隷:(NO:主人)
		CUP:奴隷:不快 *= 100
		CUP:奴隷:不快 /= RELATION:奴隷:(NO:主人)
		CUP:奴隷:抑鬱 *= 100
		CUP:奴隷:抑鬱 /= RELATION:奴隷:(NO:主人)
	ENDIF
	;-------------------------------------------------
	;気力０による上下の処理
	;-------------------------------------------------
	IF BASE:奴隷:1 <= 0
		;UP:0,1,2は絶頂に絡むので先に処理してある
		CUP:奴隷:欲情 /= 2
		CUP:奴隷:恭順 /= 2
		CUP:奴隷:屈服 /= 2
		CUP:奴隷:習得 /= 2
		CUP:奴隷:恥情 /= 2
		CUP:奴隷:恐怖 /= 2
		CUP:奴隷:苦痛 /= 2
		DOWNBASE:奴隷:体力 *= 2
		DOWNBASE:奴隷:体力 += 80
	ENDIF
	;-------------------------------------------------
	;苦痛からくる体力・気力の減少
	;-------------------------------------------------
	LOCAL = CUP:奴隷:苦痛 / 20
	;ABL:マゾっ気をみる
	SELECTCASE ABL:奴隷:マゾっ気
		CASE 0
			TIMES LOCAL , 1.00
		CASE 1
			TIMES LOCAL , 0.95
		CASE 2
			TIMES LOCAL , 0.90
		CASE 3
			TIMES LOCAL , 0.80
		CASE 4
			TIMES LOCAL , 0.65
		CASEELSE
			TIMES LOCAL , 0.50
	ENDSELECT
	;痛覚
	LOCAL = LOCAL * (10 + TALENT:奴隷:痛覚 * 2) / 10
	DOWNBASE:奴隷:体力 += LOCAL
	DOWNBASE:奴隷:気力 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_DOWNBASE(奴隷,主人=0)
	#DIM 奴隷
	#DIM 主人
	BASE:奴隷:体力 = MAX(0,BASE:奴隷:体力 - DOWNBASE:奴隷:体力)
	BASE:奴隷:気力 = MAX(0,BASE:奴隷:気力 - DOWNBASE:奴隷:気力)
