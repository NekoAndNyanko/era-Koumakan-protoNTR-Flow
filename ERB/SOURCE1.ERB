;-------------------------------------------------------------------------------
;非TARGET依存性SOURCE
;-------------------------------------------------------------------------------
;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_EXP(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
SIF SOURCE:奴隷:快Ｃ
	EXP:奴隷:Ｃ经验 ++
IF SOURCE:奴隷:快Ｖ && (!TALENT:奴隷:处女 || !TFLAG:2)
	EXP:奴隷:Ｖ经验 ++
ENDIF
SIF SOURCE:奴隷:快Ａ
	EXP:奴隷:Ａ经验 ++
SIF SOURCE:奴隷:快Ｂ
	EXP:奴隷:Ｂ经验 ++
SIF CFLAG:奴隷:跳蛋挿入 && EXP_UP(1,奴隷) > 0
	EXP:奴隷:Ｖ经验 --
SIF CFLAG:奴隷:跳蛋A挿入 && EXP_UP(2,奴隷) > 0
	EXP:奴隷:Ａ经验 --

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_快Ｃ(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;Ｃ敏感とＣ鈍感はここで処理
SOURCE:奴隷:快Ｃ = SOURCE:奴隷:快Ｃ * (2 + TALENT:奴隷:Ｃ感度) / 2
;C感覚
SOURCE:奴隷:快Ｃ = SOURCE:奴隷:快Ｃ * SOURCE_REVISION1(ABL:奴隷:Ｃ感觉) / 10
LOCAL = SOURCE:奴隷:快Ｃ
;PALAM:欲情をみる
IF PALAM:奴隷:欲情 < PALAMLV:1
	TIMES LOCAL , 0.80
ELSEIF PALAM:奴隷:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:奴隷:欲情 < PALAMLV:3
	TIMES LOCAL , 1.20
ELSEIF PALAM:奴隷:欲情 < PALAMLV:4
	TIMES LOCAL , 1.40
ELSEIF PALAM:奴隷:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.60
ENDIF
CUP:奴隷:快Ｃ += LOCAL
LOCAL = SOURCE:奴隷:快Ｃ
;ABL:欲望をみる
LOCAL = LOCAL * SOURCE_REVISION2(ABL:奴隷:欲望) / 100
CUP:奴隷:欲情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_快Ｖ(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;Ｖ敏感とＶ鈍感はここで処理
SOURCE:奴隷:快Ｖ = SOURCE:奴隷:快Ｖ * (2 + TALENT:奴隷:Ｖ感度) / 2
;V感覚
SOURCE:奴隷:快Ｖ = SOURCE:奴隷:快Ｖ * SOURCE_REVISION1(ABL:奴隷:Ｖ感觉) / 10
;EXP:Ｖ经验をみる
IF EXP:奴隷:Ｖ经验 < EXPLV:1
	TIMES SOURCE:奴隷:快Ｖ , 0.30
ELSEIF EXP:奴隷:Ｖ经验 < EXPLV:2
	TIMES SOURCE:奴隷:快Ｖ , 0.50
ELSEIF EXP:奴隷:Ｖ经验 < EXPLV:3
	TIMES SOURCE:奴隷:快Ｖ , 0.80
ELSEIF EXP:奴隷:Ｖ经验 < EXPLV:4
	TIMES SOURCE:奴隷:快Ｖ , 1.00
ELSEIF EXP:奴隷:Ｖ经验 < EXPLV:5
	TIMES SOURCE:奴隷:快Ｖ , 1.20
ELSEIF EXP:奴隷:Ｖ经验 >= EXPLV:5
	TIMES SOURCE:奴隷:快Ｖ , 1.50
ENDIF
;PALAM:润滑をみる
IF PALAM:奴隷:润滑 < PALAMLV:1
	TIMES SOURCE:奴隷:快Ｖ , 0.10
ELSEIF PALAM:奴隷:润滑 < PALAMLV:2
	TIMES SOURCE:奴隷:快Ｖ , 0.40
ELSEIF PALAM:奴隷:润滑 < PALAMLV:3
	TIMES SOURCE:奴隷:快Ｖ , 0.60
ELSEIF PALAM:奴隷:润滑 < PALAMLV:4
	TIMES SOURCE:奴隷:快Ｖ , 0.80
ELSEIF PALAM:奴隷:润滑 >= PALAMLV:4
	TIMES SOURCE:奴隷:快Ｖ , 1.00
ENDIF
LOCAL = SOURCE:奴隷:快Ｖ
LOCAL:1 = SOURCE:奴隷:快Ｖ
;PALAM:欲情をみる
IF PALAM:奴隷:欲情 < PALAMLV:1
	TIMES LOCAL , 0.60
ELSEIF PALAM:奴隷:欲情 < PALAMLV:2
	TIMES LOCAL , 0.80
ELSEIF PALAM:奴隷:欲情 < PALAMLV:3
	TIMES LOCAL , 1.00
ELSEIF PALAM:奴隷:欲情 < PALAMLV:4
	TIMES LOCAL , 1.20
ELSEIF PALAM:奴隷:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.50
ENDIF
;締り具合
IF 締り具合名称(BASE:奴隷:Ｖ松弛度) == "松紧合适"
	TIMES LOCAL, 0.85
ELSEIF 締り具合名称(BASE:奴隷:Ｖ松弛度) == "きゅうきゅう"
	TIMES LOCAL, 0.70
ELSEIF 締り具合名称(BASE:奴隷:Ｖ松弛度) == "松松垮垮了"
	TIMES LOCAL, 0.55
ELSEIF 締り具合名称(BASE:奴隷:Ｖ松弛度) == "已经合不拢了"
	TIMES LOCAL, 0.40
ENDIF
;ABL:欲望をみる
LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:奴隷:欲望) / 100
;小人体型
IF TALENT:奴隷:体型 < -2
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 1.20
ENDIF
CUP:奴隷:快Ｖ += LOCAL
CUP:奴隷:欲情 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_快Ａ(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;Ａ敏感とＡ鈍感はここで処理
SOURCE:奴隷:快Ａ = SOURCE:奴隷:快Ａ * (2 + TALENT:奴隷:Ａ感度) / 2
;A感覚
SOURCE:奴隷:快Ａ = SOURCE:奴隷:快Ａ * SOURCE_REVISION1(ABL:奴隷:Ａ感觉) / 10
;EXP:Ａ经验をみる
IF EXP:奴隷:Ａ经验 < EXPLV:1
	TIMES SOURCE:奴隷:快Ａ , 0.30
ELSEIF EXP:奴隷:Ａ经验 < EXPLV:2
	TIMES SOURCE:奴隷:快Ａ , 0.50
ELSEIF EXP:奴隷:Ａ经验 < EXPLV:3
	TIMES SOURCE:奴隷:快Ａ , 0.80
ELSEIF EXP:奴隷:Ａ经验 < EXPLV:4
	TIMES SOURCE:奴隷:快Ａ , 1.00
ELSEIF EXP:奴隷:Ａ经验 < EXPLV:5
	TIMES SOURCE:奴隷:快Ａ , 1.20
ELSEIF EXP:奴隷:Ａ经验 >= EXPLV:5
	TIMES SOURCE:奴隷:快Ａ , 1.50
ENDIF
;PALAM:润滑をみる
IF PALAM:奴隷:润滑 < PALAMLV:1
	TIMES SOURCE:奴隷:快Ａ , 0.40
ELSEIF PALAM:奴隷:润滑 < PALAMLV:2
	TIMES SOURCE:奴隷:快Ａ , 0.60
ELSEIF PALAM:奴隷:润滑 < PALAMLV:3
	TIMES SOURCE:奴隷:快Ａ , 0.80
ELSEIF PALAM:奴隷:润滑 < PALAMLV:4
	TIMES SOURCE:奴隷:快Ａ , 0.90
ELSEIF PALAM:奴隷:润滑 >= PALAMLV:4
	TIMES SOURCE:奴隷:快Ａ , 1.00
ENDIF
LOCAL = SOURCE:奴隷:快Ａ
LOCAL:1 = SOURCE:奴隷:快Ａ
;PALAM:欲情をみる
;快ＡはあまりPALAM:欲情では差が出ない
IF PALAM:奴隷:欲情 < PALAMLV:1
	TIMES LOCAL , 0.90
ELSEIF PALAM:奴隷:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:奴隷:欲情 < PALAMLV:3
	TIMES LOCAL , 1.10
ELSEIF PALAM:奴隷:欲情 < PALAMLV:4
	TIMES LOCAL , 1.20
ELSEIF PALAM:奴隷:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.30
ENDIF
;締り具合
IF 締り具合名称(BASE:奴隷:Ａ松弛度) == "松紧合适"
	TIMES LOCAL, 0.85
ELSEIF 締り具合名称(BASE:奴隷:Ａ松弛度) == "きゅうきゅう"
	TIMES LOCAL, 0.70
ELSEIF 締り具合名称(BASE:奴隷:Ａ松弛度) == "松松垮垮了"
	TIMES LOCAL, 0.55
ELSEIF 締り具合名称(BASE:奴隷:Ａ松弛度) == "已经合不拢了"
	TIMES LOCAL, 0.40
ENDIF
;ABL:欲望をみる
LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:奴隷:欲望) / 100
;小人体型
IF TALENT:奴隷:体型 < -2
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 1.50
ENDIF
;快Aのソースが0以上で处女で贞操観念のとき、屈服のソースを三分の一にする
IF EXP:奴隷:Ｖ经验 == 0 && TALENT:奴隷:贞操 > 0 && SOURCE:奴隷:快Ａ > 0
	SOURCE:奴隷:屈从 /= 3
ENDIF
CUP:奴隷:快Ａ += LOCAL
CUP:奴隷:欲情 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_快Ｂ(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;Ｂ敏感とＢ鈍感はここで処理
SOURCE:奴隷:快Ｂ = SOURCE:奴隷:快Ｂ * (2 + TALENT:奴隷:Ｂ感度) / 2
;B感覚
SOURCE:奴隷:快Ｂ = SOURCE:奴隷:快Ｂ * SOURCE_REVISION1(ABL:奴隷:Ｂ感觉) / 10
LOCAL = SOURCE:奴隷:快Ｂ
;PALAM:欲情をみる
IF PALAM:奴隷:欲情 < PALAMLV:1
	TIMES LOCAL , 0.80
ELSEIF PALAM:奴隷:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:奴隷:欲情 < PALAMLV:3
	TIMES LOCAL , 1.20
ELSEIF PALAM:奴隷:欲情 < PALAMLV:4
	TIMES LOCAL , 1.40
ELSEIF PALAM:奴隷:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.60
ENDIF
CUP:奴隷:快Ｂ += LOCAL
LOCAL = SOURCE:奴隷:快Ｂ
;ABL:欲望をみる
LOCAL = LOCAL * SOURCE_REVISION2(ABL:奴隷:欲望) / 100
CUP:奴隷:欲情 += LOCAL

;-----------------------------------------------------
;与快CVAB
;-----------------------------------------------------
@SOURCE_与快Ｃ(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;Ｃ敏感とＣ鈍感はここで処理
SOURCE:奴隷:与快Ｃ = SOURCE:奴隷:与快Ｃ * (2 + TALENT:主人:Ｃ感度) / 2
;C感覚
SOURCE:奴隷:与快Ｃ = SOURCE:奴隷:与快Ｃ * SOURCE_REVISION1(ABL:主人:Ｃ感觉) / 10
LOCAL = SOURCE:奴隷:与快Ｃ
;PALAM:欲情をみる
IF PALAM:主人:欲情 < PALAMLV:1
	TIMES LOCAL , 0.80
ELSEIF PALAM:主人:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:主人:欲情 < PALAMLV:3
	TIMES LOCAL , 1.20
ELSEIF PALAM:主人:欲情 < PALAMLV:4
	TIMES LOCAL , 1.40
ELSEIF PALAM:主人:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.60
ENDIF
CUP:主人:快Ｃ += LOCAL
LOCAL = SOURCE:奴隷:与快Ｃ
;ABL:欲望をみる
LOCAL = LOCAL * SOURCE_REVISION2(ABL:主人:欲望) / 100
CUP:主人:欲情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_与快Ｖ(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;Ｖ敏感とＶ鈍感はここで処理
SOURCE:奴隷:与快Ｖ = SOURCE:奴隷:与快Ｖ * (2 + TALENT:主人:Ｖ感度) / 2
;V感覚
SOURCE:奴隷:与快Ｖ = SOURCE:奴隷:与快Ｖ * SOURCE_REVISION1(ABL:主人:Ｖ感觉) / 10
;EXP:Ｖ经验をみる
IF EXP:主人:Ｖ经验 < EXPLV:1
	TIMES SOURCE:奴隷:与快Ｖ , 0.30
ELSEIF EXP:主人:Ｖ经验 < EXPLV:2
	TIMES SOURCE:奴隷:与快Ｖ , 0.50
ELSEIF EXP:主人:Ｖ经验 < EXPLV:3
	TIMES SOURCE:奴隷:与快Ｖ , 0.80
ELSEIF EXP:主人:Ｖ经验 < EXPLV:4
	TIMES SOURCE:奴隷:与快Ｖ , 1.00
ELSEIF EXP:主人:Ｖ经验 < EXPLV:5
	TIMES SOURCE:奴隷:与快Ｖ , 1.20
ELSEIF EXP:主人:Ｖ经验 >= EXPLV:5
	TIMES SOURCE:奴隷:与快Ｖ , 1.50
ENDIF
;PALAM:润滑をみる
IF PALAM:主人:润滑 < PALAMLV:1
	TIMES SOURCE:奴隷:与快Ｖ , 0.10
ELSEIF PALAM:主人:润滑 < PALAMLV:2
	TIMES SOURCE:奴隷:与快Ｖ , 0.40
ELSEIF PALAM:主人:润滑 < PALAMLV:3
	TIMES SOURCE:奴隷:与快Ｖ , 0.60
ELSEIF PALAM:主人:润滑 < PALAMLV:4
	TIMES SOURCE:奴隷:与快Ｖ , 0.80
ELSEIF PALAM:主人:润滑 >= PALAMLV:4
	TIMES SOURCE:奴隷:与快Ｖ , 1.00
ENDIF
LOCAL = SOURCE:奴隷:与快Ｖ
LOCAL:1 = SOURCE:奴隷:与快Ｖ
;PALAM:欲情をみる
IF PALAM:主人:欲情 < PALAMLV:1
	TIMES LOCAL , 0.60
ELSEIF PALAM:主人:欲情 < PALAMLV:2
	TIMES LOCAL , 0.80
ELSEIF PALAM:主人:欲情 < PALAMLV:3
	TIMES LOCAL , 1.00
ELSEIF PALAM:主人:欲情 < PALAMLV:4
	TIMES LOCAL , 1.20
ELSEIF PALAM:主人:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.50
ENDIF
;ABL:欲望をみる
LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:主人:欲望) / 100
;小人体型
IF TALENT:主人:体型 < -2
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 1.20
ENDIF
CUP:主人:快Ｖ += LOCAL
CUP:主人:欲情 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_与快Ａ(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;Ａ敏感とＡ鈍感はここで処理
SOURCE:奴隷:与快Ａ = SOURCE:奴隷:与快Ａ * (2 + TALENT:主人:Ａ感度) / 2
;A感覚
SOURCE:奴隷:与快Ａ = SOURCE:奴隷:与快Ａ * SOURCE_REVISION1(ABL:主人:Ａ感觉) / 10
;EXP:Ａ经验をみる
IF EXP:主人:Ａ经验 < EXPLV:1
	TIMES SOURCE:奴隷:与快Ａ , 0.30
ELSEIF EXP:主人:Ａ经验 < EXPLV:2
	TIMES SOURCE:奴隷:与快Ａ , 0.50
ELSEIF EXP:主人:Ａ经验 < EXPLV:3
	TIMES SOURCE:奴隷:与快Ａ , 0.80
ELSEIF EXP:主人:Ａ经验 < EXPLV:4
	TIMES SOURCE:奴隷:与快Ａ , 1.00
ELSEIF EXP:主人:Ａ经验 < EXPLV:5
	TIMES SOURCE:奴隷:与快Ａ , 1.20
ELSEIF EXP:主人:Ａ经验 >= EXPLV:5
	TIMES SOURCE:奴隷:与快Ａ , 1.50
ENDIF
;PALAM:润滑をみる
IF PALAM:主人:润滑 < PALAMLV:1
	TIMES SOURCE:奴隷:与快Ａ , 0.40
ELSEIF PALAM:主人:润滑 < PALAMLV:2
	TIMES SOURCE:奴隷:与快Ａ , 0.60
ELSEIF PALAM:主人:润滑 < PALAMLV:3
	TIMES SOURCE:奴隷:与快Ａ , 0.80
ELSEIF PALAM:主人:润滑 < PALAMLV:4
	TIMES SOURCE:奴隷:与快Ａ , 0.90
ELSEIF PALAM:主人:润滑 >= PALAMLV:4
	TIMES SOURCE:奴隷:与快Ａ , 1.00
ENDIF
LOCAL = SOURCE:奴隷:与快Ａ
LOCAL:1 = SOURCE:奴隷:与快Ａ
;PALAM:欲情をみる
;快ＡはあまりPALAM:欲情では差が出ない
IF PALAM:主人:欲情 < PALAMLV:1
	TIMES LOCAL , 0.90
ELSEIF PALAM:主人:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:主人:欲情 < PALAMLV:3
	TIMES LOCAL , 1.10
ELSEIF PALAM:主人:欲情 < PALAMLV:4
	TIMES LOCAL , 1.20
ELSEIF PALAM:主人:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.30
ENDIF
;ABL:欲望をみる
LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:主人:欲望) / 100
;小人体型
IF TALENT:主人:体型 < -2
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 1.50
ENDIF
CUP:主人:快Ａ += LOCAL
CUP:主人:欲情 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_与快Ｂ(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;Ｂ敏感とＢ鈍感はここで処理
SOURCE:奴隷:与快Ｂ = SOURCE:奴隷:与快Ｂ * (2 + TALENT:主人:Ｂ感度) / 2
;B感覚
SOURCE:奴隷:与快Ｂ = SOURCE:奴隷:与快Ｂ * SOURCE_REVISION1(ABL:主人:Ｂ感觉) / 10
LOCAL = SOURCE:奴隷:与快Ｂ
;PALAM:欲情をみる
IF PALAM:主人:欲情 < PALAMLV:1
	TIMES LOCAL , 0.80
ELSEIF PALAM:主人:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:主人:欲情 < PALAMLV:3
	TIMES LOCAL , 1.20
ELSEIF PALAM:主人:欲情 < PALAMLV:4
	TIMES LOCAL , 1.40
ELSEIF PALAM:主人:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.60
ENDIF
CUP:主人:快Ｂ += LOCAL
LOCAL = SOURCE:奴隷:与快Ｂ
;ABL:欲望をみる
LOCAL = LOCAL * SOURCE_REVISION2(ABL:主人:欲望) / 100
CUP:主人:欲情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_CVAB_EXTRA(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;-------------------------------------------------
;气力０による上下の処理（快楽系）
;-------------------------------------------------
IF BASE:奴隷:气力 <= 0
	;UP:0,1,2,3は絶頂に絡むので先に処理してある
	CUP:奴隷:快Ｃ /= 2
	CUP:奴隷:快Ｖ /= 2
	CUP:奴隷:快Ａ /= 2
	CUP:奴隷:快Ｂ /= 2
ENDIF
;-------------------------------------------------
;相性による上下の処理（快楽系）
;-------------------------------------------------
IF 主人 < CHARANUM && RELATION:奴隷:(NO:主人) != 0
	CUP:奴隷:快Ｃ *= RELATION:奴隷:(NO:主人)
	CUP:奴隷:快Ｃ /= 100
	CUP:奴隷:快Ｖ *= RELATION:奴隷:(NO:主人)
	CUP:奴隷:快Ｖ /= 100
	CUP:奴隷:快Ａ *= RELATION:奴隷:(NO:主人)
	CUP:奴隷:快Ａ /= 100
	CUP:奴隷:快Ｂ *= RELATION:奴隷:(NO:主人)
	CUP:奴隷:快Ｂ /= 100
ENDIF
;-------------------------------------------------
;快感の否定は、快ソースの数値に応じて、抑郁増加（淫乱で無効）
;-------------------------------------------------
SIF TALENT:奴隷:快感应答 < 0 && !TALENT:奴隷:淫乱
	SOURCE:奴隷:抑郁 += (CUP:奴隷:快Ｃ + CUP:奴隷:快Ｖ + CUP:奴隷:快Ａ + CUP:奴隷:快Ｂ)/10
;-------------------------------------------------
;素質などによる上下の処理（快楽系）
;-------------------------------------------------
;媚药
IF TEQUIP:奴隷:媚药
	TIMES CUP:奴隷:快Ｃ , 2.00
	TIMES CUP:奴隷:快Ｖ , 2.00
	TIMES CUP:奴隷:快Ａ , 2.00
	TIMES CUP:奴隷:快Ｂ , 2.00
ENDIF
;利尿剂
IF TEQUIP:奴隷:利尿剂
	TIMES CUP:奴隷:快Ｃ , 0.70
	TIMES CUP:奴隷:快Ｖ , 0.70
	TIMES CUP:奴隷:快Ａ , 0.70
	TIMES CUP:奴隷:快Ｂ , 0.70
ENDIF
;-------------------------------------------------
;陥落素質
;-------------------------------------------------
;淫乱
IF TALENT:奴隷:淫乱
	TIMES CUP:奴隷:快Ｃ , 1.20
	TIMES CUP:奴隷:快Ｖ , 1.20
	TIMES CUP:奴隷:快Ａ , 1.20
	TIMES CUP:奴隷:快Ｂ , 1.20
ENDIF
;-------------------------------------------------
;素質
;-------------------------------------------------
;自制心
IF TALENT:奴隷:自制心
	TIMES CUP:奴隷:快Ｃ , 0.70
	TIMES CUP:奴隷:快Ｖ , 0.90
	TIMES CUP:奴隷:快Ａ , 1.00
	TIMES CUP:奴隷:快Ｂ , 0.70
ENDIF
;立即陷落
IF TALENT:奴隷:立即陷落
	TIMES CUP:奴隷:快Ｃ , 2.00
	TIMES CUP:奴隷:快Ｖ , 2.00
	TIMES CUP:奴隷:快Ａ , 2.00
	TIMES CUP:奴隷:快Ｂ , 2.00
ENDIF
;自慰狂
SIF TALENT:奴隷:自慰狂
	TIMES CUP:奴隷:快Ｃ , 1.20
;淫壶
SIF TALENT:奴隷:淫壶
	TIMES CUP:奴隷:快Ｖ , 1.20
;淫肛
SIF TALENT:奴隷:淫肛
	TIMES CUP:奴隷:快Ａ , 1.20
;淫乳
SIF TALENT:奴隷:淫乳
	TIMES CUP:奴隷:快Ｂ , 1.20
;オトコ
IF !(HAS_VAGINA(奴隷))
	TIMES CUP:奴隷:快Ａ , 1.30
ENDIF
;-------------------------------------------------
;難易度による上下の処理（快楽系）
;-------------------------------------------------
CUP:奴隷:快Ｃ = CUP:奴隷:快Ｃ * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:快Ｖ = CUP:奴隷:快Ｖ * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:快Ａ = CUP:奴隷:快Ａ * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:快Ｂ = CUP:奴隷:快Ｂ * (16 - 4 * FLAG:難易度) / 10
;-------------------------------------------------
;愛液処理
;-------------------------------------------------
LOCAL:1 = CUP:奴隷:快Ｃ + CUP:奴隷:快Ｖ + CUP:奴隷:快Ａ + CUP:奴隷:快Ｂ
;快Ｃ＋快Ｖ＋快Ａ＋快Ｂが合わせて100以上上昇ならその20%の液体のソースが加わる
IF LOCAL:1 > 100
	;濡れやすいと濡れにくいはここで処理
	LOCAL:1 = LOCAL:1 * (10 + 5 * TALENT:奴隷:濡湿度) / 10
	SOURCE:奴隷:液体 += LOCAL:1 / 5
ENDIF

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_情爱(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:情爱
;ABL:顺从をみる
SELECTCASE ABL:奴隷:顺从
	CASE 0
		TIMES LOCAL , 0.10
	CASE 1
		TIMES LOCAL , 0.50
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.50
	CASE 4
		TIMES LOCAL , 2.00
	CASE 5
		TIMES LOCAL , 2.50
	CASE 6
		TIMES LOCAL , 3.00
	CASE 7
		TIMES LOCAL , 3.50
	CASE 8
		TIMES LOCAL , 4.00
	CASE 9
		TIMES LOCAL , 5.00
	CASEELSE
		TIMES LOCAL , 6.00
ENDSELECT
CUP:奴隷:恭顺 += LOCAL
LOCAL = SOURCE:奴隷:情爱
;欲望を見る
SELECTCASE ABL:奴隷:欲望
	CASE 0
		TIMES LOCAL , 0.00
	CASE 1
		TIMES LOCAL , 0.40
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.60
	CASE 5
		TIMES LOCAL , 2.00
	CASE 6
		TIMES LOCAL , 2.40
	CASE 7
		TIMES LOCAL , 2.80
	CASE 8
		TIMES LOCAL , 3.20
	CASE 9
		TIMES LOCAL , 3.60
	CASEELSE
		TIMES LOCAL , 5.00
ENDSELECT
CUP:奴隷:欲情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_性行动(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:性行动
;ABL:技巧をみる
SELECTCASE ABL:奴隷:技巧
	CASE 0
		TIMES LOCAL , 0.60
	CASE 1
		TIMES LOCAL , 1.20
	CASE 2
		TIMES LOCAL , 1.80
	CASE 3
		TIMES LOCAL , 2.40
	CASE 4
		TIMES LOCAL , 3.00
	CASE 5
		TIMES LOCAL , 3.60
	CASE 6
		TIMES LOCAL , 4.20
	CASE 7
		TIMES LOCAL , 4.80
	CASE 8
		TIMES LOCAL , 5.40
	CASE 9
		TIMES LOCAL , 6.00
	CASEELSE
		TIMES LOCAL , 7.00
ENDSELECT
;ABL:侍奉精神をみる
SELECTCASE ABL:奴隷:侍奉精神
	CASE 0
		TIMES LOCAL , 0.60
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.40
	CASE 5
		TIMES LOCAL , 1.70
	CASE 6
		TIMES LOCAL , 2.00
	CASE 7
		TIMES LOCAL , 2.40
	CASE 8
		TIMES LOCAL , 2.80
	CASE 9
		TIMES LOCAL , 4.00
	CASEELSE
		TIMES LOCAL , 5.00
ENDSELECT
CUP:奴隷:习得 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_达成(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:达成
;ABL:顺从をみる
SELECTCASE ABL:奴隷:顺从
	CASE 0
		TIMES LOCAL , 0.50
	CASE 1
		TIMES LOCAL , 1.00
	CASE 2
		TIMES LOCAL , 1.50
	CASE 3
		TIMES LOCAL , 2.00
	CASE 4
		TIMES LOCAL , 2.50
	CASE 5
		TIMES LOCAL , 3.00
	CASE 6
		TIMES LOCAL , 3.50
	CASE 7
		TIMES LOCAL , 4.00
	CASE 8
		TIMES LOCAL , 4.50
	CASE 9
		TIMES LOCAL , 5.00
	CASEELSE
		TIMES LOCAL , 6.00
ENDSELECT
;ABL:侍奉精神をみる
SELECTCASE ABL:奴隷:侍奉精神
	CASE 0
		TIMES LOCAL , 0.00
	CASE 1
		TIMES LOCAL , 0.50
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.50
	CASE 4
		TIMES LOCAL , 2.00
	CASE 5
		TIMES LOCAL , 2.50
	CASE 6
		TIMES LOCAL , 3.00
	CASE 7
		TIMES LOCAL , 3.50
	CASE 8
		TIMES LOCAL , 4.00
	CASE 9
		TIMES LOCAL , 4.50
	CASEELSE
		TIMES LOCAL , 6.00
ENDSELECT
CUP:奴隷:恭顺 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_苦痛(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:苦痛
LOCAL:1 = SOURCE:奴隷:苦痛
LOCAL:2 = SOURCE:奴隷:苦痛 / 20
;抖Ｍ之气
SELECTCASE ABL:奴隷:抖Ｍ之气
	CASE 0
		TIMES LOCAL:1 , 0.00
	CASE 1
		TIMES LOCAL:1 , 0.10
	CASE 2
		TIMES LOCAL:1 , 0.20
	CASE 3
		TIMES LOCAL:1 , 0.30
	CASE 4
		TIMES LOCAL:1 , 0.45
	CASE 5
		TIMES LOCAL:1 , 0.60
	CASE 6
		TIMES LOCAL:1 , 0.75
	CASE 7
		TIMES LOCAL:1 , 0.90
	CASE 8
		TIMES LOCAL:1 , 1.20
	CASE 9
		TIMES LOCAL:1 , 1.50
	CASEELSE
		TIMES LOCAL:1 , 3.00
ENDSELECT
;小人体型
IF TALENT:奴隷:体型 < -2
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.75
ENDIF
;調教者が【施虐狂】
IF 主人 < CHARANUM && TALENT:主人:施虐狂
	TIMES LOCAL:1 , 2.50
ELSEIF 主人 == 人物_客 ;客は【施虐狂】であると仮定
	TIMES LOCAL:1 , 2.50
ELSEIF 主人 == 人物_訪問者 ;訪問者は【施虐狂】であると仮定
	TIMES LOCAL:1 , 2.50
ENDIF
;臆病
SIF TALENT:奴隷:胆量 < 0
	TIMES LOCAL:2 , 2.00
;抖Ｍ之气があるとPALAM:欲情も上がる
;そのとき調教者が【施虐狂】だと効果的
;苦痛に応じて恐怖のソースが増加する
CUP:奴隷:苦痛 += LOCAL
CUP:奴隷:欲情 += LOCAL:1
CUP:奴隷:恐怖 += LOCAL:2

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_恐怖(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL= SOURCE:奴隷:恐怖
;ABL:顺从をみる（恐怖よりは畏怖に近いと解釈）
SELECTCASE ABL:奴隷:顺从
	CASE 0
		TIMES LOCAL, 1.00
	CASE 1
		TIMES LOCAL, 1.50
	CASE 2
		TIMES LOCAL, 2.00
	CASE 3
		TIMES LOCAL, 2.50
	CASE 4
		TIMES LOCAL, 3.00
	CASE 5
		TIMES LOCAL, 3.50
	CASE 6
		TIMES LOCAL, 4.00
	CASE 7
		TIMES LOCAL, 4.50
	CASE 8
		TIMES LOCAL, 5.00
	CASE 9
		TIMES LOCAL, 5.50
	CASEELSE
		TIMES LOCAL, 7.00
ENDSELECT
CUP:奴隷:恐怖 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_液体(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:液体
;小人体型
IF TALENT:奴隷:体型 < -2
	SIF SELECTCOM != 50 && SELECTCOM != 180
		TIMES LOCAL , 0.40
ENDIF
CUP:奴隷:润滑 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_欲情(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:欲情
;欲望を見る
SELECTCASE ABL:奴隷:欲望
	CASE 0
		TIMES LOCAL , 0.20
	CASE 1
		TIMES LOCAL , 0.40
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.60
	CASE 5
		TIMES LOCAL , 2.00
	CASE 6
		TIMES LOCAL , 2.40
	CASE 7
		TIMES LOCAL , 2.80
	CASE 8
		TIMES LOCAL , 3.20
	CASE 9
		TIMES LOCAL , 3.60
	CASEELSE
		TIMES LOCAL , 5.00
ENDSELECT
CUP:奴隷:欲情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_恭顺(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:恭顺
;ABL:顺从をみる
SELECTCASE ABL:奴隷:顺从
	CASE 0
		TIMES LOCAL , 0.50
	CASE 0
		TIMES LOCAL , 0.80
	CASE 0
		TIMES LOCAL , 1.00
	CASE 0
		TIMES LOCAL , 1.20
	CASE 0
		TIMES LOCAL , 1.40
	CASE 0
		TIMES LOCAL , 1.60
	CASE 0
		TIMES LOCAL , 1.80
	CASE 0
		TIMES LOCAL , 2.00
	CASE 0
		TIMES LOCAL , 2.40
	CASE 0
		TIMES LOCAL , 3.00
	CASE 0
		TIMES LOCAL , 5.00
ENDSELECT
CUP:奴隷:恭顺 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_露出(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;恥じらいと恥薄いはここで処理
SIF TALENT:奴隷:羞耻心 > 0
	TIMES SOURCE:奴隷:露出 , 2.00
SIF TALENT:奴隷:羞耻心 < 0
	TIMES SOURCE:奴隷:露出 , 0.50
;润滑アップの50％を露出のソースに加える
;ただし液体追加のソースのぶんは引く
SOURCE:奴隷:露出 += (CUP:奴隷:润滑 - SOURCE:奴隷:液体) / 2
LOCAL = SOURCE:奴隷:露出
;ABL:露出癖をみる
SELECTCASE ABL:奴隷:露出癖
	CASE 0
		TIMES LOCAL , 0.00
	CASE 1
		TIMES LOCAL , 0.10
	CASE 2
		TIMES LOCAL , 0.20
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.80
	CASE 6
		TIMES LOCAL , 1.00
	CASE 7
		TIMES LOCAL , 1.20
	CASE 8
		TIMES LOCAL , 1.40
	CASE 9
		TIMES LOCAL , 1.60
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT
CUP:奴隷:欲情 += LOCAL
LOCAL = SOURCE:奴隷:露出
;PALAM:耻情をみる
;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
IF PALAM:奴隷:耻情 < PALAMLV:1
	TIMES LOCAL , 1.00
ELSEIF PALAM:奴隷:耻情 < PALAMLV:2
	TIMES LOCAL , 0.90
ELSEIF PALAM:奴隷:耻情 < PALAMLV:3
	TIMES LOCAL , 0.80
ELSEIF PALAM:奴隷:耻情 < PALAMLV:4
	TIMES LOCAL , 0.70
ELSEIF PALAM:奴隷:耻情 >= PALAMLV:4
	TIMES LOCAL , 0.60
ENDIF
CUP:奴隷:耻情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_屈从(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:屈从
;ABL:顺从をみる
SELECTCASE ABL:奴隷:顺从
	CASE 0
		TIMES LOCAL , 0.50
	CASE 1
		TIMES LOCAL , 1.00
	CASE 2
		TIMES LOCAL , 1.50
	CASE 3
		TIMES LOCAL , 2.00
	CASE 4
		TIMES LOCAL , 2.50
	CASE 5
		TIMES LOCAL , 3.00
	CASE 6
		TIMES LOCAL , 3.50
	CASE 7
		TIMES LOCAL , 4.00
	CASE 8
		TIMES LOCAL , 4.50
	CASE 9
		TIMES LOCAL , 5.00
	CASEELSE
		TIMES LOCAL , 6.00
ENDSELECT
;ABL:侍奉精神をみる
SELECTCASE ABL:奴隷:侍奉精神
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.50
	CASE 2
		TIMES LOCAL , 2.00
	CASE 3
		TIMES LOCAL , 2.50
	CASE 4
		TIMES LOCAL , 3.00
	CASE 5
		TIMES LOCAL , 3.50
	CASE 6
		TIMES LOCAL , 4.00
	CASE 7
		TIMES LOCAL , 4.50
	CASE 8
		TIMES LOCAL , 5.00
	CASE 9
		TIMES LOCAL , 5.50
	CASEELSE
		TIMES LOCAL , 7.00
ENDSELECT
CUP:奴隷:屈服 += LOCAL

;---------------------------------------------------
;PLAYERにも影響を与えるSOURCE
;---------------------------------------------------
@SOURCE_欢乐(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:欢乐
;恋慕
LOCAL = LOCAL * (10 + 5 * TALENT:奴隷:恋慕) / 10
;ABL:亲密をみる
IF LOCAL < 100000
	LOCAL = LOCAL * (ABL:奴隷:亲密 * 5 + 100) / 100
ELSEIF LOCAL < 100000000
	LOCAL = LOCAL / 100 * (ABL:奴隷:亲密 * 5 + 100)
ENDIF
;ABL:欲望をみる
IF LOCAL < 100000
	LOCAL = LOCAL * (ABL:奴隷:欲望 * 5 + 100) / 100
ELSEIF LOCAL < 100000000
	LOCAL = LOCAL / 100 * (ABL:奴隷:欲望 * 5 + 100)
ENDIF
;好感度を見る
IF CFLAG:奴隷:好感度 <= 10
	TIMES LOCAL , 0.50
ELSEIF CFLAG:奴隷:好感度 <= 50
	TIMES LOCAL , 0.80
ELSEIF CFLAG:奴隷:好感度 <= 100
	TIMES LOCAL , 1.00
ELSEIF CFLAG:奴隷:好感度 <= 300
	TIMES LOCAL , 1.10
ELSEIF CFLAG:奴隷:好感度 <= 500
	TIMES LOCAL , 1.20
ELSEIF CFLAG:奴隷:好感度 <= 700
	TIMES LOCAL , 1.30
ELSEIF CFLAG:奴隷:好感度 <= 1000
	TIMES LOCAL , 1.40
ELSEIF CFLAG:奴隷:好感度 <= 3000
	TIMES LOCAL , 1.50
ELSEIF CFLAG:奴隷:好感度 <= 5000
	TIMES LOCAL , 1.70
ELSEIF CFLAG:奴隷:好感度 <= 500000
	IF LOCAL < 100000
		LOCAL = LOCAL * (CFLAG:奴隷:好感度 / 50 + 100) / 100
	ELSEIF LOCAL < 10000000
		LOCAL = LOCAL / 100 * (CFLAG:奴隷:好感度 / 50 + 100)
	ELSEIF LOCAL < 100000000
		IF CFLAG:奴隷:好感度 <= 50000
			LOCAL = LOCAL / 100 * (CFLAG:奴隷:好感度 / 50 + 100)
		ELSE
			LOCAL = 1000000000
		ENDIF
	ENDIF
ENDIF
CUP:奴隷:好意 += LOCAL
IF 主人 < CHARANUM
	CUP:主人:欲情 += MIN(LOCAL / 10 , 100)
ENDIF

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_征服(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;地位で分岐
IF 主人 < CHARANUM && CFLAG:奴隷:310 > CFLAG:主人:310
	;高位のキャラ
	LOCAL:1 = SOURCE:奴隷:征服 / 4
	;ABL:欲望をみる
	SELECTCASE ABL:奴隷:欲望
		CASE 0
			TIMES LOCAL:1 , 0.10
		CASE 1
			TIMES LOCAL:1 , 0.15
		CASE 2
			TIMES LOCAL:1 , 0.20
		CASE 3
			TIMES LOCAL:1 , 0.25
		CASE 4
			TIMES LOCAL:1 , 0.30
		CASEELSE
			IF LOCAL:1 < 100000
				LOCAL:1 = LOCAL:1 * (ABL:奴隷:欲望 * 5 + 15) / 100
			ELSEIF LOCAL:1 < 100000000
				LOCAL:1 = LOCAL:1 / 100 * (ABL:奴隷:欲望 * 5 + 15)
			ENDIF
	ENDSELECT
	;ABL:抖Ｓ之气をみる
	IF LOCAL:1 < 100000
		LOCAL:1 = LOCAL:1 * (ABL:奴隷:抖Ｓ之气 * 30 + 100) / 100
	ELSEIF LOCAL:1 < 100000000
		LOCAL:1 = LOCAL:1 / 100 * (ABL:奴隷:抖Ｓ之气 * 30 + 100)
	ENDIF
ELSE
	;低位のキャラ
	LOCAL:2 = SOURCE:奴隷:征服 / 2
	;ABL:亲密をみる
	SELECTCASE ABL:奴隷:亲密
		CASE 0
			TIMES LOCAL:2 , 0.10
		CASE 1
			TIMES LOCAL:2 , 0.15
		CASE 2
			TIMES LOCAL:2 , 0.20
		CASE 3
			TIMES LOCAL:2 , 0.25
		CASE 4
			TIMES LOCAL:2 , 0.30
		CASEELSE
			IF LOCAL:2 < 100000
				LOCAL:2 = LOCAL:2 * (ABL:奴隷:亲密 * 5 + 15) / 100
			ELSEIF LOCAL:2 < 100000000
				LOCAL:2 = LOCAL:2 / 100 * (ABL:奴隷:亲密 * 5 + 15)
			ENDIF
	ENDSELECT
ENDIF
LOCAL = SOURCE:奴隷:征服
;ABL:抖Ｓ之气をみる
SELECTCASE ABL:奴隷:抖Ｓ之气
	CASE 0
		TIMES LOCAL , 0.70
	CASE 1
		TIMES LOCAL , 1.00
	CASE 2
		TIMES LOCAL , 1.30
	CASE 3
		TIMES LOCAL , 1.70
	CASE 4
		TIMES LOCAL , 2.00
	CASEELSE
		IF LOCAL < 100000
			LOCAL = LOCAL * (ABL:奴隷:抖Ｓ之气 * 15 + 175) / 100
		ELSEIF LOCAL < 100000000
			LOCAL = LOCAL / 100 * (ABL:奴隷:抖Ｓ之气 * 15 + 175)
		ENDIF
ENDSELECT
CUP:奴隷:优越 += LOCAL
CUP:奴隷:欲情 += LOCAL:1
IF 主人 < CHARANUM
	CUP:主人:屈服 += LOCAL:1
ENDIF
CUP:奴隷:耻情 += LOCAL:2

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_被动(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
IF 主人 > CHARANUM || CFLAG:奴隷:310 > CFLAG:主人:310
	;高位のキャラ
	LOCAL:1 = SOURCE:奴隷:被动 / 3
	;ABL:欲望をみる
	SELECTCASE ABL:奴隷:欲望
		CASE 0
			TIMES LOCAL:1 , 0.30
		CASE 1
			TIMES LOCAL:1 , 0.35
		CASE 2
			TIMES LOCAL:1 , 0.40
		CASE 3
			TIMES LOCAL:1 , 0.45
		CASE 4
			TIMES LOCAL:1 , 0.50
		CASEELSE
			IF LOCAL:1 < 100000
				LOCAL:1 = LOCAL:1 * (ABL:奴隷:欲望 * 10 + 10) / 100
			ELSEIF LOCAL:1 < 100000000
				LOCAL:1 = LOCAL:1 / 100 * (ABL:奴隷:欲望 * 10 + 10)
			ENDIF
	ENDSELECT
ELSE
	LOCAL:2 = SOURCE:奴隷:被动 / 2
	;ABL:侍奉精神をみる
	SELECTCASE ABL:奴隷:侍奉精神
		CASE 0
			TIMES LOCAL:2 , 0.30
		CASE 1
			TIMES LOCAL:2 , 0.35
		CASE 2
			TIMES LOCAL:2 , 0.40
		CASE 3
			TIMES LOCAL:2 , 0.45
		CASE 4
			TIMES LOCAL:2 , 0.50
		CASEELSE
			IF LOCAL:2 < 100000
				LOCAL:2 = LOCAL:2 * (ABL:奴隷:侍奉精神 * 10 + 10) / 100
			ELSEIF LOCAL:2 < 100000000
				LOCAL:2 = LOCAL:2 / 100 * (ABL:奴隷:侍奉精神 * 10 + 10)
			ENDIF
	ENDSELECT
ENDIF
LOCAL = SOURCE:奴隷:被动
;ABL:亲密をみる
IF LOCAL < 100000
	LOCAL = LOCAL * (ABL:奴隷:亲密 * 10 + 70) / 100
ELSEIF LOCAL < 100000000
	LOCAL = LOCAL / 100 * (ABL:奴隷:亲密 * 10 + 70)
ENDIF
CUP:奴隷:好意 += LOCAL
CUP:奴隷:屈服 += LOCAL:1
IF 主人 < CHARANUM
	CUP:主人:恭顺 += LOCAL:1
ENDIF
CUP:奴隷:恭顺 += LOCAL:2

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_诱惑(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
SOURCE:奴隷:诱惑 = SOURCE:奴隷:诱惑 * GET_REVISION(ABL:奴隷:欲望 + 2, 500, 10) / 100
LOCAL = SOURCE:奴隷:诱惑
LOCAL:1 = SOURCE:奴隷:诱惑
LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:欲望, 500, 20)) / 100
CUP:主人:欲情 += LOCAL
LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:主人:顺从, 500, 5)) / 100
CUP:主人:恭顺 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_侮辱(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
SOURCE:奴隷:侮辱 = SOURCE:奴隷:侮辱 * GET_REVISION(ABL:奴隷:抖Ｓ之气 + 2, 500, 10) / 100
LOCAL = SOURCE:奴隷:侮辱
LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:抖Ｍ之气, 500, 20)) / 100
LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:露出癖, 500, 20)) / 100
;PALAM:耻情をみる
;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
IF PALAM:主人:耻情 < PALAMLV:1
	TIMES LOCAL , 1.00
ELSEIF PALAM:主人:耻情 < PALAMLV:2
	TIMES LOCAL , 0.90
ELSEIF PALAM:主人:耻情 < PALAMLV:3
	TIMES LOCAL , 0.80
ELSEIF PALAM:主人:耻情 < PALAMLV:4
	TIMES LOCAL , 0.70
ELSEIF PALAM:主人:耻情 >= PALAMLV:4
	TIMES LOCAL , 0.60
ENDIF
CUP:主人:耻情 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_挑衅(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
SOURCE:奴隷:挑衅 = SOURCE:奴隷:挑衅 * GET_REVISION(ABL:奴隷:抖Ｓ之气 + 2, 500, 10) / 100
LOCAL = SOURCE:奴隷:挑衅
LOCAL:1 = SOURCE:奴隷:挑衅
LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:欲望, 500, 10)) / 100
CUP:主人:欲情 += LOCAL
LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:主人:抖Ｍ之气, 500, 5)) / 100
CUP:主人:屈服 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_侍奉(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
SOURCE:奴隷:侍奉 = SOURCE:奴隷:侍奉 * GET_REVISION(ABL:奴隷:技巧 + ABL:奴隷:侍奉精神 + 2, 500, 10) / 100
LOCAL = SOURCE:奴隷:侍奉
LOCAL:1 = SOURCE:奴隷:侍奉
LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:欲望, 500, 10)) / 100
CUP:主人:欲情 += LOCAL
LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:主人:抖Ｍ之气, 500, 5)) / 100
CUP:主人:屈服 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_强迫(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
SOURCE:奴隷:强迫 = SOURCE:奴隷:强迫 * GET_REVISION(ABL:奴隷:抖Ｓ之气 +ABL:奴隷:欲望 + 2, 500, 10) / 100
LOCAL = SOURCE:奴隷:强迫
LOCAL:1 = SOURCE:奴隷:强迫
LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:侍奉精神, 500, 5)) / 100
CUP:主人:恭顺 += LOCAL
LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:主人:顺从, 500, 10)) / 100
CUP:主人:屈服 += LOCAL:1

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_虐待(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
SOURCE:奴隷:虐待 = SOURCE:奴隷:虐待 * GET_REVISION(ABL:奴隷:抖Ｓ之气 + ABL:奴隷:欲望 + 2, 500, 5) / 100
LOCAL = SOURCE:奴隷:虐待
LOCAL:1 = SOURCE:奴隷:虐待
LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:抖Ｍ之气, 500, 10)) / 100
CUP:主人:苦痛 += LOCAL
LOCAL = LOCAL * (100 + GET_REVISION(ABL:主人:抖Ｍ之气, 500, 5)) / 100
CUP:主人:恐怖 += LOCAL
LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:主人:顺从, 500, 10)) / 100
CUP:主人:屈服 += LOCAL:1

;---------------------------------------------------
;マイナスSOURCE
;---------------------------------------------------
@SOURCE_肮脏(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:肮脏
;ABL:顺从をみる
SELECTCASE ABL:奴隷:顺从
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
CUP:奴隷:不快 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_抑郁(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:抑郁
;ABL:顺从をみる
SELECTCASE ABL:奴隷:顺从
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
;ABL:欲望をみる
SELECTCASE ABL:奴隷:欲望
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
CUP:奴隷:抑郁 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_逸脱(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;好奇心と保守的はここで処理
SIF TALENT:奴隷:性的兴趣 > 0
	TIMES SOURCE:奴隷:逸脱 , 0.80
SIF TALENT:奴隷:性的兴趣 < 0
	TIMES SOURCE:奴隷:逸脱 , 2.00
LOCAL = SOURCE:奴隷:逸脱
;ABL:顺从をみる
SELECTCASE ABL:奴隷:顺从
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
;ABL:抖Ｍ之气をみる
SELECTCASE ABL:奴隷:抖Ｍ之气
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
CUP:奴隷:反感 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_反感(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
LOCAL = SOURCE:奴隷:反感
;ABL:顺从をみる
LOCAL:1 = ABL:奴隷:顺从 + ABL:奴隷:亲密
SELECTCASE LOCAL:1
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
;ABL:侍奉精神をみる
SELECTCASE ABL:奴隷:侍奉精神
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
;ABL:抖Ｍ之气をみる
SELECTCASE ABL:奴隷:抖Ｍ之气
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
CUP:奴隷:反感 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_EXTRA(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
VARSET LOCAL
;-------------------------------------------------
;装備系（薬等）
;-------------------------------------------------
;媚药
IF TEQUIP:奴隷:媚药
	TIMES CUP:奴隷:恭顺 , 1.20
	TIMES CUP:奴隷:欲情 , 2.00
	TIMES CUP:奴隷:屈服 , 1.20
	TIMES CUP:奴隷:不快 , 0.75
ENDIF
;利尿剂
IF TEQUIP:奴隷:利尿剂
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:欲情 , 0.80
	TIMES CUP:奴隷:耻情 , 1.20
	TIMES CUP:奴隷:反感 , 1.50
	TIMES CUP:奴隷:不快 , 1.20
ENDIF
;-------------------------------------------------
;陥落素質
;-------------------------------------------------
;恋慕
IF TALENT:奴隷:恋慕 && ASSIPLAY == 0
	CUP:奴隷:恭顺 = CUP:奴隷:恭顺 * (10 + 5 * TALENT:奴隷:恋慕) / 10
	CUP:奴隷:屈服 = CUP:奴隷:屈服 * (10 + 5 * TALENT:奴隷:恋慕) / 10
	SIF CUP:奴隷:好意 < 999999999
		CUP:奴隷:好意 = CUP:奴隷:好意 * (10 + 5 * TALENT:奴隷:恋慕) / 10
	CUP:奴隷:反感 = CUP:奴隷:反感 * (10 - 4 * TALENT:奴隷:恋慕) / 10
	CUP:奴隷:不快 = CUP:奴隷:不快 * (10 - 4 * TALENT:奴隷:恋慕) / 10
	TIMES CUP:奴隷:抑郁 , 0.50
ELSEIF TALENT:奴隷:恋慕 && ASSIPLAY > 0
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:反感 , 1.20
	TIMES CUP:奴隷:不快 , 1.20
ENDIF
;淫乱
IF TALENT:奴隷:淫乱
	CUP:奴隷:恭顺 = CUP:奴隷:恭顺 * (10 + 2 * TALENT:奴隷:淫乱) / 10
	CUP:奴隷:屈服 = CUP:奴隷:屈服 * (10 + 2 * TALENT:奴隷:淫乱) / 10
	CUP:奴隷:反感 = CUP:奴隷:反感 * (10 - 2 * TALENT:奴隷:淫乱) / 10
	CUP:奴隷:不快 = CUP:奴隷:不快 * (10 - 2 * TALENT:奴隷:淫乱) / 10
	TIMES CUP:奴隷:抑郁 , 0.40
ENDIF
;-------------------------------------------------
;素質
;-------------------------------------------------
;気丈
IF TALENT:奴隷:胆量 > 0
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:欲情 , 0.80
	TIMES CUP:奴隷:屈服 , 0.80
	TIMES CUP:奴隷:恐怖 , 0.80
	TIMES CUP:奴隷:好意 , 0.80
	TIMES CUP:奴隷:反感 , 1.20
	TIMES CUP:奴隷:抑郁 , 1.20
ENDIF
;臆病
IF TALENT:奴隷:胆量 < 0
	TIMES CUP:奴隷:恐怖 , 1.20
	TIMES CUP:奴隷:反感 , 1.20
ENDIF
;反抗的（服从、隷属で無効）
IF TALENT:奴隷:态度 > 0 && !TALENT:奴隷:服从
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:屈服 , 0.80
	TIMES CUP:奴隷:好意 , 0.80
	TIMES CUP:奴隷:反感 , 1.20
ENDIF
;素直
IF TALENT:奴隷:态度 < 0
	TIMES CUP:奴隷:恭顺 , 1.20
	TIMES CUP:奴隷:反感 , 0.80
	SIF CUP:奴隷:好意 < 999999999
		TIMES CUP:奴隷:好意 , 1.50
ENDIF
;生意気
IF TALENT:奴隷:应答 > 0
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:屈服 , 0.80
	TIMES CUP:奴隷:反感 , 1.20
ENDIF
;大人しい
IF TALENT:奴隷:应答 < 0
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:反感 , 0.80
ENDIF
;自尊心高い
IF TALENT:奴隷:自尊心 > 0
	TIMES CUP:奴隷:屈服 , 0.80
	TIMES CUP:奴隷:恐怖 , 0.80
	TIMES CUP:奴隷:反感 , 1.20
ENDIF
;自尊心低い
IF TALENT:奴隷:自尊心 < 0
	TIMES CUP:奴隷:屈服 , 1.20
	TIMES CUP:奴隷:恐怖 , 1.20
	TIMES CUP:奴隷:反感 , 0.80
ENDIF
;傲娇
IF TALENT:奴隷:傲娇
	;陥落素質がある場合と無い場合で変化する
	IF TALENT:奴隷:恋慕 || TALENT:奴隷:淫乱 || TALENT:奴隷:服从
		TIMES CUP:奴隷:恭顺 , 1.20
		TIMES CUP:奴隷:屈服 , 1.20
		TIMES CUP:奴隷:反感 , 0.80
	ELSE
		TIMES CUP:奴隷:恭顺 , 0.80
		TIMES CUP:奴隷:屈服 , 0.80
		TIMES CUP:奴隷:反感 , 1.20
	ENDIF
ENDIF
;自制心
IF TALENT:奴隷:自制心
	TIMES CUP:奴隷:屈服 , 0.80
	TIMES CUP:奴隷:恐怖 , 0.80
	TIMES CUP:奴隷:反感 , 1.20
ENDIF
;漠不关心
IF TALENT:奴隷:漠不关心
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:欲情 , 0.80
	TIMES CUP:奴隷:屈服 , 0.80
	TIMES CUP:奴隷:好意 , 0.80
	TIMES CUP:奴隷:恐怖 , 0.80
	TIMES CUP:奴隷:反感 , 0.80
ENDIF
;缺乏感情
IF TALENT:奴隷:缺乏感情
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:欲情 , 0.80
	TIMES CUP:奴隷:屈服 , 0.80
	TIMES CUP:奴隷:耻情 , 0.80
	TIMES CUP:奴隷:恐怖 , 0.80
	TIMES CUP:奴隷:好意 , 0.80
	TIMES CUP:奴隷:反感 , 0.80
	TIMES CUP:奴隷:不快 , 0.80
	TIMES CUP:奴隷:抑郁 , 0.80
ENDIF
;好奇心
SIF TALENT:奴隷:性的兴趣 > 0
	TIMES CUP:奴隷:习得 , 1.20
;保守的
SIF TALENT:奴隷:性的兴趣 < 0
	TIMES CUP:奴隷:习得 , 0.80
;楽観的
SIF TALENT:奴隷:開朗／阴郁 > 0
	TIMES CUP:奴隷:抑郁 , 0.80
;悲観的
SIF TALENT:奴隷:開朗／阴郁 < 0
	TIMES CUP:奴隷:抑郁 , 1.20
;表现欲
SIF TALENT:奴隷:表现欲
	TIMES CUP:奴隷:恭顺 , 1.20
;抑圧
IF TALENT:奴隷:自己爱 < 0
	TIMES CUP:奴隷:欲情 , 0.80
	TIMES CUP:奴隷:反感 , 1.20
	TIMES CUP:奴隷:抑郁 , 1.20
ENDIF
;解放
IF TALENT:奴隷:自己爱 > 0
	TIMES CUP:奴隷:欲情 , 1.20
	TIMES CUP:奴隷:屈服 , 1.20
ENDIF
;抵抗
IF TALENT:奴隷:抵抗
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:反感 , 1.20
	TIMES CUP:奴隷:抑郁 , 1.20
ENDIF
;痛觉
CUP:奴隷:苦痛 = CUP:奴隷:苦痛 * (10 + 2 * TALENT:奴隷:痛觉) / 10
;习得速度
CUP:奴隷:习得 = CUP:奴隷:习得 * (10 + 2 * TALENT:奴隷:习得速度) / 10
;献身的
SIF TALENT:奴隷:献身的
	TIMES CUP:奴隷:屈服 , 1.20
;快感に素直
SIF TALENT:奴隷:快感应答 > 0
	TIMES CUP:奴隷:欲情 , 1.20
;快感の否定（淫乱、娼婦で無効）
SIF TALENT:奴隷:快感应答 < 0 && !TALENT:奴隷:淫乱
	TIMES CUP:奴隷:欲情 , 0.80
;立即陷落
IF TALENT:奴隷:立即陷落
	TIMES CUP:奴隷:恭顺 , 2.00
	TIMES CUP:奴隷:欲情 , 2.00
	TIMES CUP:奴隷:屈服 , 2.00
	TIMES CUP:奴隷:习得 , 2.00
	TIMES CUP:奴隷:耻情 , 2.00
	TIMES CUP:奴隷:恐怖 , 2.00
	TIMES CUP:奴隷:反感 , 0.50
	TIMES CUP:奴隷:不快 , 0.50
	TIMES CUP:奴隷:抑郁 , 0.50
ENDIF
;自慰狂
SIF TALENT:奴隷:自慰狂
	TIMES CUP:奴隷:欲情 , 1.20
;淫壶
SIF TALENT:奴隷:淫壶
	TIMES CUP:奴隷:恭顺 , 1.20
;淫肛
SIF TALENT:奴隷:淫肛
	TIMES CUP:奴隷:屈服 , 1.20
;淫乳
SIF TALENT:奴隷:淫乳
	TIMES CUP:奴隷:耻情 , 1.20
;倒错的
IF TALENT:奴隷:倒错的
	TIMES CUP:奴隷:屈服 , 1.20
	TIMES CUP:奴隷:耻情 , 1.20
ENDIF
;男嫌い（女性のみ恋慕、亲爱で無効）
IF TALENT:奴隷:性別嗜好 & 1 && !(HAS_VAGINA(PLAYER)) && (!TALENT:奴隷:恋慕 || PLAYER != MASTER)
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:欲情 , 0.80
	TIMES CUP:奴隷:屈服 , 0.80
	TIMES CUP:奴隷:习得 , 0.80
	TIMES CUP:奴隷:反感 , 1.20
	TIMES CUP:奴隷:不快 , 1.20
ENDIF
;施虐狂
IF TALENT:奴隷:施虐狂
	TIMES CUP:奴隷:优越 , 2.00
	TIMES CUP:奴隷:屈服 , 0.80
	TIMES CUP:奴隷:恐怖 , 0.80
ENDIF
;受虐狂
IF TALENT:奴隷:受虐狂
	TIMES CUP:奴隷:屈服 , 1.20
	TIMES CUP:奴隷:恐怖 , 1.20
	TIMES CUP:奴隷:抑郁 , 0.80
ENDIF
IF TALENT:奴隷:小恶魔
	TIMES CUP:奴隷:优越 , 1.50
ENDIF
;妄信
IF TALENT:奴隷:妄信
	TIMES CUP:奴隷:屈服 , 1.20
	TIMES CUP:奴隷:反感 , 0.80
ENDIF
;女嫌い（男性のみ恋慕、亲爱で無効）
IF TALENT:奴隷:性別嗜好 & 2 && (HAS_VAGINA(PLAYER)) && (!TALENT:奴隷:恋慕 || PLAYER != MASTER )
	TIMES CUP:奴隷:恭顺 , 0.80
	TIMES CUP:奴隷:欲情 , 0.80
	TIMES CUP:奴隷:屈服 , 0.80
	TIMES CUP:奴隷:习得 , 0.80
	TIMES CUP:奴隷:反感 , 1.20
	TIMES CUP:奴隷:不快 , 1.20
ENDIF
;-------------------------------------------------
;その他
;-------------------------------------------------
;苦痛刻印
IF MARK:奴隷:苦痛刻印 == 3
	TIMES CUP:奴隷:苦痛 , 1.30
	TIMES CUP:奴隷:恐怖 , 1.30
ELSEIF MARK:奴隷:苦痛刻印 == 2
	TIMES CUP:奴隷:苦痛 , 1.20
	TIMES CUP:奴隷:恐怖 , 1.20
ELSEIF MARK:奴隷:苦痛刻印 == 1
	TIMES CUP:奴隷:苦痛 , 1.10
	TIMES CUP:奴隷:恐怖 , 1.10
ENDIF
;快乐刻印
IF MARK:奴隷:快乐刻印 == 3
	TIMES CUP:奴隷:欲情 , 1.30
	TIMES CUP:奴隷:习得 , 1.30
ELSEIF MARK:奴隷:快乐刻印 == 2
	TIMES CUP:奴隷:欲情 , 1.20
	TIMES CUP:奴隷:习得 , 1.20
ELSEIF MARK:奴隷:快乐刻印 == 1
	TIMES CUP:奴隷:欲情 , 1.10
	TIMES CUP:奴隷:习得 , 1.10
ENDIF
;屈服刻印
IF MARK:奴隷:屈服刻印 == 3
	TIMES CUP:奴隷:恭顺 , 1.30
	TIMES CUP:奴隷:屈服 , 1.30
ELSEIF MARK:奴隷:屈服刻印 == 2
	TIMES CUP:奴隷:恭顺 , 1.20
	TIMES CUP:奴隷:屈服 , 1.20
ELSEIF MARK:奴隷:屈服刻印 == 1
	TIMES CUP:奴隷:恭顺 , 1.10
	TIMES CUP:奴隷:屈服 , 1.10
ENDIF
;反発刻印
IF MARK:奴隷:反発刻印 == 3
	TIMES CUP:奴隷:恭顺 , 0.10
	TIMES CUP:奴隷:反感 , 1.30
ELSEIF MARK:奴隷:反発刻印 == 2
	TIMES CUP:奴隷:恭顺 , 0.40
	TIMES CUP:奴隷:反感 , 1.20
ELSEIF MARK:奴隷:反発刻印 == 1
	TIMES CUP:奴隷:恭顺 , 0.60
	TIMES CUP:奴隷:反感 , 1.10
ENDIF
;-------------------------------------------------
;難易度などによる上下の処理
;-------------------------------------------------
CUP:奴隷:润滑 = CUP:奴隷:润滑 * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:恭顺 = CUP:奴隷:恭顺 * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:欲情 = CUP:奴隷:欲情 * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:屈服 = CUP:奴隷:屈服 * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:习得 = CUP:奴隷:习得 * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:耻情 = CUP:奴隷:耻情 * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:苦痛 = CUP:奴隷:苦痛 * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:恐怖 = CUP:奴隷:恐怖 * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:好意 = CUP:奴隷:好意 * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:优越 = CUP:奴隷:优越 * (16 - 4 * FLAG:難易度) / 10
CUP:奴隷:反感 = CUP:奴隷:反感 * (8 +  4 * FLAG:難易度) / 10
CUP:奴隷:不快 = CUP:奴隷:不快 * (8 + 4 * FLAG:難易度) / 10
CUP:奴隷:抑郁 = CUP:奴隷:抑郁 * (8 + 4 * FLAG:難易度) / 10
;-------------------------------------------------
;相性による上下の処理
;-------------------------------------------------
IF 主人 < CHARANUM && RELATION:奴隷:(NO:主人) != 0
	CUP:奴隷:欲情 *= RELATION:奴隷:(NO:主人)
	CUP:奴隷:欲情 /= 100
	CUP:奴隷:屈服 *= RELATION:奴隷:(NO:主人)
	CUP:奴隷:屈服 /= 100
	CUP:奴隷:耻情 *= RELATION:奴隷:(NO:主人)
	CUP:奴隷:耻情 /= 100
	CUP:奴隷:反感 *= 100
	CUP:奴隷:反感 /= RELATION:奴隷:(NO:主人)
	CUP:奴隷:不快 *= 100
	CUP:奴隷:不快 /= RELATION:奴隷:(NO:主人)
	CUP:奴隷:抑郁 *= 100
	CUP:奴隷:抑郁 /= RELATION:奴隷:(NO:主人)
ENDIF
;-------------------------------------------------
;气力０による上下の処理
;-------------------------------------------------
IF BASE:奴隷:1 <= 0
	;UP:0,1,2は絶頂に絡むので先に処理してある
	CUP:奴隷:欲情 /= 2
	CUP:奴隷:恭顺 /= 2
	CUP:奴隷:屈服 /= 2
	CUP:奴隷:习得 /= 2
	CUP:奴隷:耻情 /= 2
	CUP:奴隷:恐怖 /= 2
	CUP:奴隷:苦痛 /= 2
	DOWNBASE:奴隷:体力 *= 2
	DOWNBASE:奴隷:体力 += 80
ENDIF
;-------------------------------------------------
;苦痛からくる体力・气力の減少
;-------------------------------------------------
LOCAL = CUP:奴隷:苦痛 / 20
;ABL:抖Ｍ之气をみる
SELECTCASE ABL:奴隷:抖Ｍ之气
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.95
	CASE 2
		TIMES LOCAL , 0.90
	CASE 3
		TIMES LOCAL , 0.80
	CASE 4
		TIMES LOCAL , 0.65
	CASEELSE
		TIMES LOCAL , 0.50
ENDSELECT
;痛觉
LOCAL = LOCAL * (10 + TALENT:奴隷:痛觉 * 2) / 10
DOWNBASE:奴隷:体力 += LOCAL
DOWNBASE:奴隷:气力 += LOCAL

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SOURCE_DOWNBASE(奴隷,主人=0)
#DIM 奴隷
#DIM 主人
BASE:奴隷:体力 = MAX(0,BASE:奴隷:体力 - DOWNBASE:奴隷:体力)
BASE:奴隷:气力 = MAX(0,BASE:奴隷:气力 - DOWNBASE:奴隷:气力)
